import{L as I}from"./atmosphere-ui-5b718e83.js";import{f as h,p as c,A as N,B as L,K as j,o as m,c as v,w as n,O as o,a as r,b as E,g as y,i as D,u as s,l as F,d as U,e as R,C as K}from"./app-fc313f38.js";import{_ as W,I as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-87835da0.js";import{_ as z}from"./TransactionSearch-03c1bdf8.js";import{u as G,_ as H,F as J}from"./useServerSearch-8502c7d2.js";import{_ as P,a as Q}from"./DraftButtons-d5577951.js";import{_ as X}from"./LogerButton-370ed8f9.js";import{u as Y}from"./isMobile-3d69cdae.js";import{_ as Z}from"./StatusButtons-37bad538.js";import{u as tt}from"./index-975c57c9.js";import"./formatMoney-da670e0a.js";import"./AppIcon-36bb04e5.js";/* empty css                                                */import"./Modal-ca404241.js";/* empty css                                              */import"./LogerInput-2f23c230.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./TransactionsTable-d91fffe7.js";import"./exact-math.node-672740b8.js";import"./NumberHider-888bcf03.js";import"./index-3a6f8c36.js";import"./Progress-f6cc10fb.js";import"./Dropdown-1335b583.js";import"./SectionTitle-df81ac17.js";import"./vue-draggable-next.esm-bundler-25f0042a.js";import"./constants-cb26b0c1.js";import"./WidgetCard-97abea05.js";import"./SectionNav-7e8b141c.js";import"./CustomTable-71b7dae3.js";const et={class:"flex items-center w-full space-x-2"},Vt={__name:"Transactions",props:{transactions:{type:Object,default:()=>({data:[]})},accounts:{type:Array,default:()=>[]},categories:{type:Array,default(){return[]}},serverSearchOptions:{type:Object,default:()=>({})},accountId:{type:[Number,null]}},setup(p){var _;const k=p,i=tt(),f=h(!1),u=c(()=>i.isMobile?f.value:!0),x=c(()=>i.isMobile?z:P),S=c(()=>i.isMobile?u.value?"All transactions":"Accounts":"Transactions"),w=()=>{if(i.isMobile&&u.value){f.value=!1;return}return o.visit(route("finance"))},{serverSearchOptions:l}=N(k),{state:d,executeSearchWithDelay:T}=G(l,{manual:!0}),A=c(()=>{var t;return(t=l.value.filters)==null?void 0:t.account_id});L("selectedAccountId",A.value);const $=c(()=>{var t;return((t=l.value.filters)==null?void 0:t.status)=="draft"}),B=t=>{o.delete(`/transactions/${t.id}`,{onSuccess(){o.reload()}})},C=t=>{o.patch(`/transactions/${t.id}/linked`,{onSuccess(){o.reload()}})},{openTransactionModal:g}=Y(),V=t=>{g({transactionData:t})},M={verified:{label:"Verified",value:"/finance/transactions?"},scheduled:{label:"Scheduled",value:"/finance/transactions?filter[status]=scheduled"},draft:{label:"Drafts",value:"/finance/transactions?filter[status]=draft&relationships=linked"}},b=h(((_=l.value.filters)==null?void 0:_.status)||"verified");return(t,e)=>{const O=j("ripple");return m(),v(W,{title:S.value,onBack:w,"show-back-button":!0},{header:n(()=>[r(H,null,{actions:n(()=>[E("div",et,[$.value?(m(),v(Q,{key:0})):y("",!0),r(X,{variant:"inverse"},{default:n(()=>[D(" Add transaction ")]),_:1}),r(Z,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),statuses:M,onChange:e[1]||(e[1]=a=>s(o).visit(a))},null,8,["modelValue"]),r(s(I),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",startDate:s(d).dates.startDate,"onUpdate:startDate":e[2]||(e[2]=a=>s(d).dates.startDate=a),endDate:s(d).dates.endDate,"onUpdate:endDate":e[3]||(e[3]=a=>s(d).dates.endDate=a),onChange:e[4]||(e[4]=a=>s(T)(500)),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["startDate","endDate"])])]),_:1})]),default:n(()=>[r(J,{title:"Transactions",accounts:p.accounts,"force-show-panel":!u.value},F({default:n(()=>[u.value?(m(),v(K(x.value),{key:0,transactions:p.transactions.data,"server-search-options":s(l),"all-accounts":"",onFindLinked:C,onRemoved:B,onEdit:V},null,40,["transactions","server-search-options"])):y("",!0)]),_:2},[s(i).isMobile?{name:"prepend-panel",fn:n(()=>[U((m(),R("button",{class:"flex items-center justify-between w-full px-4 py-3 font-bold text-body-1 bg-base-lvl-3",onClick:e[5]||(e[5]=a=>f.value=!0)},[D(" All accounts "),r(q,{class:"transform rotate-180"})])),[[O]])]),key:"0"}:void 0]),1032,["accounts","force-show-panel"])]),_:1},8,["title"])}}};export{Vt as default};
