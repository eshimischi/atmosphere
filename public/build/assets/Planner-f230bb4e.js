import{B as G,q as N,Z as F,L as U}from"./atmosphere-ui-b819c890.js";import{y as O,B as k,J as I,j as S,o as a,c as V,w as u,b as m,s as B,i as b,f as n,t as p,a as c,ac as W,a5 as Z,q as M,T as E,u as D,F as h,h as w,O as y}from"./app-114b751b.js";import{s as C,_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-c7e24bdb.js";import{_ as K}from"./Modal-c2871cdd.js";import{_ as z}from"./MealSection-b9f4a445.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as Q}from"./MealTemplate-c37f7fbb.js";import{_ as X}from"./MealSectionNav-6fd33fa7.js";import{_ as Y}from"./MealTypeCell-83c6f753.js";import{_ as R}from"./LogerButton-7d66d0a8.js";import{f as L}from"./isMobile-e3872359.js";import"./formatMoney-75af80f0.js";import"./useFirebase-fe12e715.js";import"./AppIcon-f342d706.js";/* empty css                                                */import"./LogerInput-8ca4e824.js";/* empty css                                              */import"./IconHeartOutline-49f40b38.js";import"./SectionTitle-20b8f2ca.js";import"./SectionNav-dd96bdd5.js";import"./Dropdown-839d2ecf.js";import"./IconClose-c46c1987.js";const ee={emits:["close"],components:{Modal:K,AtField:G,AtInput:N,AtButton:F,Meal:z},props:{show:{default:!1},maxWidth:{default:"2xl"},closeable:{default:!0},meals:{type:Array,default(){return[]}},date:{default:new Date},title:{type:String}},setup(l,{emit:r}){const d=O({meal:null}),{show:t}=k(l),v=()=>{r("close")};I(t,()=>{t.value&&f()},{immediate:!0});const f=()=>{d.meal=null,W.get("/meals-random").then(({data:_})=>{d.meal=_})};return{...k(d),submit:f,close:v}}},te={class:"px-4 py-5 text-center text-white bg-primary sm:p-6 sm:pb-4"},se={class:"justify-center sm:flex sm:items-start"},oe={class:"mt-3 text-center sm:mt-0 sm:ml-4"},ae={class:"w-full text-4xl font-bold text-white"},le={class:"mt-5 mb-5"},ne={key:0,class:"mt-5 text-2xl"},re={key:1,class:"mt-5 text-2xl"},de={class:"mt-5"};function ie(l,r,d,t,v,f){const _=S("at-button"),g=S("modal");return a(),V(g,{show:d.show,"max-width":d.maxWidth,closeable:d.closeable,onClose:t.close},{default:u(()=>[m("div",te,[m("div",se,[m("div",oe,[m("h3",ae,[B(l.$slots,"title",{},()=>[b(" The meal is: ")])]),m("div",le,[B(l.$slots,"content",{},()=>[l.meal?(a(),n("div",ne,p(l.meal.name),1)):(a(),n("div",re," loading ... "))]),m("div",de,[c(_,{class:"text-gray-700 bg-base-lvl-1",disabled:!l.meal,onClick:r[0]||(r[0]=$=>t.submit())},{default:u(()=>[b(" Random ")]),_:1},8,["disabled"])])])])])])]),_:3},8,["show","max-width","closeable","onClose"])}const me=H(ee,[["render",ie]]),ce={class:"flex items-center justify-end ml-auto space-x-2"},ue={class:"pb-20 space-x-2"},pe={key:0,class:"py-5 overflow-hidden border rounded-md bg-base-lvl-3"},fe={key:1,class:"pt-5 overflow-hidden border divide-y-2 rounded-md text-body divide-base border-base bg-base-lvl-3"},_e=["onClick"],ye={class:"md:flex items-center mt-2 md:space-x-2"},Ge={__name:"Planner",props:{mealPlans:{type:Object,required:!0},meals:{type:Array,required:!0},ingredients:{type:Object,default(){return{}}},mode:{type:String,default:""}},setup(l){const r=l,d=Z().props,t=O({selectedDay:!1,isRandomModalOpen:!1,date:C(new Date),dateSpan:null,mode:"week",selectedMealsOfDay:[],isGroceryList:M(()=>r.mode=="grocery-list"),toggleBtnText:M(()=>t.isGroceryList?"Meal planner":"Grocery List")}),v=()=>{t.isRandomModalOpen=!0},f=e=>L(e,"iiii"),_=(e,o)=>{const s=L(e,"yyyy-MM-dd");return r.mealPlans.find(i=>i.date==s&&i.dateable.meal_type_id==o)},g=e=>e?t.isGroceryList?"":"mode=grocery-list":r.mode?`mode=${r.mode}`:"",$=()=>{y.visit(`/meal-planner?${g(!0)}`)},q=e=>{t.selectedDay=e},x=E({date:null,meals:[]}),P=e=>{!e.id&&!e.name||x.transform(()=>({date:C(t.selectedDay),meals:[e]})).post(route("meals.addPlan"),{onSuccess:()=>{x.id="",x.name="",x.reset()}})},T=e=>{e.is_liked=!e.is_liked,y.put(route("meal-planner.update",e),e,{onSuccess(){y.reload({preserveScroll:!0})}})},j=e=>{e.is_liked=!e.is_liked,y.delete(route("meal-planner.destroy",e),e,{onSuccess(){y.reload({preserveScroll:!0})}})};return(e,o)=>(a(),V(J,{title:"Meal Planner"},{header:u(()=>[c(X,null,{actions:u(()=>[m("div",ce,[c(D(U),{class:"w-full h-12 ml-auto border-none bg-base-lvl-1 text-body",modelValue:t.date,"onUpdate:modelValue":o[0]||(o[0]=s=>t.date=s),dateSpan:t.dateSpan,"onUpdate:dateSpan":o[1]||(o[1]=s=>t.dateSpan=s),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"week"},null,8,["modelValue","dateSpan"]),c(R,{variant:"inverse",class:"w-64 h-10",onClick:o[2]||(o[2]=s=>v())},{default:u(()=>[b(" Random Meal ")]),_:1}),c(R,{class:"h-10 w-52",variant:"secondary",onClick:o[3]||(o[3]=s=>$())},{default:u(()=>[b(p(t.toggleBtnText),1)]),_:1})])]),_:1})]),default:u(()=>[c(Q,{class:"mx-auto"},{default:u(()=>[m("div",ue,[t.isGroceryList?(a(),n("div",pe,[(a(!0),n(h,null,w(l.ingredients,(s,i)=>(a(),n("div",{key:s.id,class:"px-5 cursor-pointer text-primary"},p(i)+" ("+p(s.quantity)+") "+p(s.unit),1))),128))])):(a(),n("div",fe,[(a(!0),n(h,null,w(t.dateSpan,s=>(a(),n("div",{key:s,onClick:i=>q(s),class:"px-5 py-4 cursor-pointer bg-base-lvl-3"},[b(p(f(s))+" ",1),m("div",ye,[(a(!0),n(h,null,w(D(d).mealTypes,i=>(a(),n("div",{class:"w-full",key:`${i.id}-${s}`},[c(Y,{modelValue:e.recipe,"onUpdate:modelValue":o[4]||(o[4]=A=>e.recipe=A),"planned-meal":_(s,i.id),"meal-type":i,onSubmit:P,onToggleLike:T,onRemoved:j},null,8,["modelValue","planned-meal","meal-type"])]))),128))])],8,_e))),128))])),c(me,{show:t.isRandomModalOpen,closeable:!0,onClose:o[5]||(o[5]=s=>t.isRandomModalOpen=!1)},null,8,["show"])])]),_:1})]),_:1}))}};export{Ge as default};
