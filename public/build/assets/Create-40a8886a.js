import{B as m,Z as k}from"./atmosphere-ui-b819c890.js";import{o as f,f as g,a as n,w as o,u as l,t as v,c as V,b as x,T as U,F as w,h as B,M as C,r as F,q as T,i as _,O}from"./app-114b751b.js";import{j,_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-c7e24bdb.js";import{_ as r}from"./LogerInput-8ca4e824.js";import{_ as N}from"./MealSectionNav-6fd33fa7.js";import{_ as L}from"./MealTemplate-c37f7fbb.js";import"./isMobile-e3872359.js";import"./formatMoney-75af80f0.js";import"./useFirebase-fe12e715.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./AppIcon-f342d706.js";/* empty css                                                */import"./Modal-c2871cdd.js";/* empty css                                              */import"./LogerButton-7d66d0a8.js";import"./SectionNav-dd96bdd5.js";import"./Dropdown-839d2ecf.js";import"./SectionTitle-20b8f2ca.js";const M={class:"flex px-2 py-2 overflow-hidden rounded-md bg-base-lvl-3"},I={key:0,class:"capitalize"},S=x("i",{class:"fa fa-trash"},null,-1),A={__name:"MealFormLine",props:{meal:{type:Object,default:()=>({name:""})},ingredient:{type:Object,required:!0},index:{type:Number}},emits:["close"],setup(a){return(s,t)=>(f(),g("div",M,[n(l(m),{class:"px-4",label:"Qty"},{default:o(()=>[n(r,{bordered:"",rounded:"",type:"number",modelValue:a.ingredient.quantity,"onUpdate:modelValue":t[0]||(t[0]=e=>a.ingredient.quantity=e)},null,8,["modelValue"])]),_:1}),n(l(m),{class:"w-full px-4",label:"Name"},{default:o(()=>[a.ingredient.product_id?(f(),g("div",I,v(a.ingredient.name),1)):(f(),V(j,{key:1,modelValue:a.ingredient.product_id,"onUpdate:modelValue":t[1]||(t[1]=e=>a.ingredient.product_id=e),label:a.ingredient.name,"onUpdate:label":[t[2]||(t[2]=e=>a.ingredient.name=e),t[3]||(t[3]=e=>s.$emit("check",e))],class:"w-full",tag:"","custom-label":"name","track-id":"id",placeholder:"Add ingredient",endpoint:"/api/ingredients"},null,8,["modelValue","label"]))]),_:1}),n(l(m),{class:"px-4",label:"Unit"},{default:o(()=>[n(r,{rounded:"",modelValue:a.ingredient.unit,"onUpdate:modelValue":t[4]||(t[4]=e=>a.ingredient.unit=e),class:"border border-none rounded-t-none rounded-b-none text-body bg-base border-base-deep-1"},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Actions"},{default:o(()=>[n(l(k),{type:"danger",class:"items-center h-10",rounded:"",onClick:t[5]||(t[5]=e=>s.removeIngredient(a.index))},{default:o(()=>[S]),_:1})]),_:1})]))}},D={class:"text-body"},Z={__name:"MealForm",props:{meal:{type:Object,default:()=>({name:""})}},emits:["close"],setup(a,{expose:s}){var u;const t=a,e=U({name:(u=t.meal)==null?void 0:u.name,ingredients:t.meal?[...t.meal.ingredients,{}]:[{}]}),c=async()=>{const p=t.meal?"put":"post",i=t.meal?`/meals/${t.meal.id}`:"/meals";e.transform(d=>({...d,ingredients:d.ingredients.filter(b=>b.name)})).submit(p,i,{onSuccess:async()=>{p=="post"&&(await C(),e.reset())}})},y=(p,i)=>{e.ingredients.length==p+1&&i&&e.ingredients.push({unit:"unit",quantity:1,product_id:"",name:""})};return s({submit:c}),(p,i)=>(f(),g("div",D,[n(l(m),{label:"Title"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[0]||(i[0]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Ingredients"},{default:o(()=>[(f(!0),g(w,null,B(l(e).ingredients,(d,b)=>(f(),V(A,{key:`${d.id}-${b}`,meal:a.meal,index:b,ingredient:d,onCheck:$=>y(b,$)},null,8,["meal","index","ingredient","onCheck"]))),128))]),_:1}),n(l(m),{label:"Tags"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[1]||(i[1]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Link"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[2]||(i[2]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Dish"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[3]||(i[3]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Time"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[4]||(i[4]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1}),n(l(m),{label:"Times Planned"},{default:o(()=>[n(r,{modelValue:l(e).name,"onUpdate:modelValue":i[5]||(i[5]=d=>l(e).name=d),rounded:""},null,8,["modelValue"])]),_:1})]))}},de={__name:"Create",props:{meals:{type:[Object,null],default:null}},setup(a){const s=a,t=F(null),e=()=>{t.value.submit()},c=T(()=>s.meals?`Meals / ${s.meals.name}`:"Create recipe");return(y,u)=>(f(),V(q,{title:c.value,"show-back-button":!0,onBack:u[1]||(u[1]=p=>l(O).visit("/meal-planner"))},{header:o(()=>[n(N,null,{actions:o(()=>[x("div",null,[n(l(k),{class:"h-10 text-white bg-primary",rounded:"",onClick:u[0]||(u[0]=p=>e())},{default:o(()=>[_(" Save ")]),_:1})])]),_:1})]),default:o(()=>[n(L,{class:"mx-auto","show-meal-types":!1},{default:o(()=>[n(Z,{ref_key:"mealForm",ref:t,meal:a.meals,class:"px-4 py-2 rounded-md bg-base-lvl-3"},null,8,["meal"])]),_:1})]),_:1},8,["title"]))}};export{de as default};
