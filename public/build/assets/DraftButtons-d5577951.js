import{L as u,f as A,x as D,o as g,e as T,a as p,w as d,b as i,n as O,t as x,u as f,j as w,i as b,O as h}from"./app-fc313f38.js";import{_ as S}from"./CustomTable-71b7dae3.js";import{I as $}from"./index-975c57c9.js";import{p as I,f as N}from"./formatMoney-da670e0a.js";import{r as E,h as v,f as M}from"./isMobile-3d69cdae.js";import{s as _}from"./AppLayout.vue_vue_type_script_setup_true_lang-87835da0.js";import{N as R}from"./Dropdown-1335b583.js";import{Z as y}from"./atmosphere-ui-5b718e83.js";function B(e,t){E(2,arguments);var s=v(e),r=v(t);return s.getTime()>r.getTime()}const P={WITHDRAW:"outflow",DEPOSIT:"inflow"},V=[{label:"Date",name:"date",width:200,class:"text-center",headerClass:"text-center",render(e){const t=I(e.date),s=B(_(t),_(new Date));return u("div",{class:s?"text-danger":"text-info cursor-pointer"},M(t,"dd MMM, yyyy"))}},{label:"Payee",name:"payee",width:400,class:"w-full",render(e){var t;try{const s=()=>{var r;return[u("div",`Transfer: ${(r=e.counterAccount)==null?void 0:r.name}`),u($,{class:"fa fa-right-left"})]};return((t=e.payee)==null?void 0:t.name)??u("div",{class:"flex justify-between items-center text-body-1 h-4"},s)}catch{return""}}},{label:"Category",name:"category",render(e){var t;return(t=e.category)==null?void 0:t.name}},{label:"Description",name:"description",width:300},{label:"Type",name:"direction",width:300,class:"text-center",headerClass:"text-center",render(e){return P[e.direction]}},{label:"Amount",name:"total",type:"custom",class:"text-right",headerClass:"text-right"},{label:"",name:"actions",width:300,type:"custom",class:"text-right"}],W={class:"pb-20 mt-5 bg-base-lvl-3"},j={class:"capitalize text-xs"},L=i("button",{class:"hover:bg-base-lvl-3 px-2"},[i("i",{class:"fa fa-ellipsis-v"})],-1),ee={__name:"TransactionTemplate",props:{transactions:{type:Array,default:()=>[]},serverSearchOptions:{type:Object,default:()=>({})},title:{type:String,default:"s"},cols:{type:Array,default(){return V}}},emits:["removed","edit","approved"],setup(e,{emit:t}){const s=A(!1),r=D({recurrence:!1,automatic:!1,transactionData:null}),c=n=>{r.transactionData=n,s.value=!0},o=n=>[{name:"edit",label:"Edit"},{name:"removed",label:"Remove"},{name:"findLinked",label:"Find Linked",hide:n.status!="draft"}].filter(a=>!a.hide),m=(n,l)=>{t(n,l)},k=n=>{var l;return(l=n.payee)!=null&&l.name?n.direction=="WITHDRAW"?"text-red-400":"text-green-500":"text-body-1"};return(n,l)=>(g(),T("div",W,[p(S,{cols:e.cols,"show-prepend":!0,"table-data":e.transactions,onEdit:c},{total:d(({scope:{row:a}})=>[i("div",{class:O(["font-bold",[k(a)]])},x(f(N)(a.total,a.currency_code)),3)]),description:d(({scope:{row:a}})=>[i("span",j,x(a.description)+" "+x(a.linked),1)]),actions:d(({scope:{row:a}})=>[i("div",null,[p(f(R),{trigger:"click","key-field":"name",options:o(a),"on-select":C=>m(C,a),onClick:l[0]||(l[0]=w(()=>{},["stop"]))},{default:d(()=>[L]),_:2},1032,["options","on-select"])])]),_:1},8,["cols","table-data"])]))}},z={class:"flex items-center w-full space-x-2"},H=i("i",{class:"block mr-2 fa fa-check"},null,-1),Z=i("i",{class:"block mr-2 fa fa-times"},null,-1),q=i("i",{class:"block fa fa-robot"},null,-1),te={__name:"DraftButtons",setup(e){const t=()=>{axios.post("/api/automation/run-all").then(c=>{console.log(c.data)}).catch(c=>{console.log(c)})},s=()=>{h.post("/transactions/remove-all-drafts",{onSuccess(){h.reload()}})},r=c=>{h.post("/transactions/approve-all-drafts",{onSuccess(){h.reload()}})};return(c,o)=>(g(),T("div",z,[p(f(y),{class:"flex items-center h-10 space-x-2 text-primary",rounded:"",onClick:o[0]||(o[0]=m=>r())},{default:d(()=>[H,b(" Approve ")]),_:1}),p(f(y),{class:"flex items-center h-10 mr-2 space-x-2 text-primary",rounded:"",onClick:o[1]||(o[1]=m=>s())},{default:d(()=>[Z,b(" Remove")]),_:1}),p(f(y),{class:"flex items-center h-10 space-x-2 text-white bg-primary",rounded:"",onClick:o[2]||(o[2]=m=>t())},{default:d(()=>[q]),_:1})]))}};export{ee as _,te as a,B as i};
