import{q as h,o as i,c as y,d as a,e as x,t as u,f as n,a as d,i as C,g as A,b as f,m as U,n as S,k as M,s as q,F as N,h as V,y as H,r as F,A as Y,a6 as Z}from"./app.d8e74fa3.js";import{Z as E,E as z}from"./atmosphere-ui.87ba2c0a.js";import{e as W,_ as X,f as J,a as K,g as O}from"./AppLayout.9d561a06.js";import{_ as R,e as j}from"./WidgetCard.e29b5449.js";import{f as k}from"./formatMoney.a91b934f.js";import{a as Q}from"./index.9c3fb553.js";import{N as ee}from"./Dropdown.8b34b419.js";import{N as te}from"./Progress.90c50bdd.js";import{_ as ae}from"./SectionTitle.5007996d.js";import{u as se,_ as ne,F as le}from"./useServerSearch.b930cc90.js";import{_ as oe}from"./BudgetProgress.b1c4eb1a.js";import"./index.a33f79b6.js";import{_ as re}from"./DonutChart.7a66c63a.js";import{ab as L,af as ie,ad as G,a6 as de}from"./naiveui.0ad5ca37.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Modal.36144344.js";/* empty css                                              */import"./LogerInput.c4e88f46.js";import"./index.0c0b7522.js";import"./SectionNav.164c7b94.js";function ce(e,t){L(2,arguments);var s=ie(e),l=G(t);if(isNaN(l))return new Date(NaN);if(!l)return s;var o=s.getDate(),p=new Date(s.getTime());p.setMonth(s.getMonth()+l+1,0);var g=p.getDate();return o>=g?p:(s.setFullYear(p.getFullYear(),p.getMonth(),o),s)}function ue(e,t){L(2,arguments);var s=G(t);return ce(e,-s)}var T,me=new Uint8Array(16);function fe(){if(!T&&(T=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!T))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return T(me)}const pe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ve(e){return typeof e=="string"&&pe.test(e)}var v=[];for(var B=0;B<256;++B)v.push((B+256).toString(16).substr(1));function ye(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase();if(!ve(s))throw TypeError("Stringified UUID is invalid");return s}function ge(e,t,s){e=e||{};var l=e.random||(e.rng||fe)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,t){s=s||0;for(var o=0;o<16;++o)t[s+o]=l[o];return t}return ye(l)}const he=e=>e.map(t=>{var s,l,o;return{id:t.id||ge(),date:t.date,title:t.description,subtitle:(s=t.account)!=null&&s.name?`${(l=t.account)==null?void 0:l.name} -> ${(o=t.category)==null?void 0:o.name}`:"",value:t.total,status:"VERIFIED",currencyCode:t.currency_code}}),be=e=>(console.log(e,"data"),e.map(t=>{var s,l,o;return{id:t.id,date:t.date,title:t.description,subtitle:`${(s=t.account)==null?void 0:s.name} -> ${(o=(l=t.category)==null?void 0:l.name)!=null?o:""} `,value:t.total,status:"PLANNED"}})),xe={class:"flex justify-between px-5 py-2"},we={class:"flex space-x-3"},$e={key:0,class:"flex items-center h-full"},ke=["checked"],Se={class:"flex items-center justify-center w-20 px-5 py-3 font-bold text-center transition-all rounded-md bg-base-lvl-3 group-hover:bg-primary group-hover:text-white group-body-1"},Ce={class:"font-bold"},_e={class:"text-sm"},Ae={class:"block text-sm"},Me={class:"flex space-x-5"},Te={class:"text-right"},De={class:"relative font-bold"},Ee={key:0,class:"text-red-500"},Ne={class:"text-sm"},Be=a("button",{class:"hover:bg-base-lvl-3 px-2"},[a("i",{class:"fa fa-ellipsis-v"})],-1),Re={key:0,class:"px-5"},Ve={__name:"TransactionCard",props:{title:String,subtitle:String,date:String,value:String,currencyCode:String,status:String,markAsPaid:Boolean,markAsApproved:Boolean,expenses:Number,allowEdit:Boolean,allowRemove:Boolean,allowSelect:Boolean,isSelected:Boolean},emits:["selected","remove"],setup(e,{emit:t}){const s=e,l=h(()=>(Number(s.expenses||0)/Number(s.value||0)*100).toFixed(2)),o=()=>{s.allowSelect&&t("selected")},p=h(()=>[{name:"edit",label:"Edit",hide:!s.allowEdit},{name:"markAsPaid",label:"Mark as paid",hide:!s.markAsPaid},{name:"approved",label:"Approve",hide:!s.markAsApproved},{name:"removed",label:"Remove",hide:!s.allowRemove}].filter(r=>!r.hide)),g=h(()=>Object.keys(p.value).length),$=w=>{t(w)};return(w,r)=>(i(),y("div",{class:S(["transition text-slate-body group",[e.allowSelect&&"cursor-pointer hover:bg-base-lvl-3 border-2 border-transparent hover:border-primary",e.isSelected?"odd:bg-primary-100 even:bg-primary":"odd:bg-base-lvl-2 even:bg-base-lvl-1"]])},[a("div",xe,[a("div",we,[e.allowSelect?(i(),y("div",$e,[a("input",{type:"checkbox",checked:e.isSelected,onChange:r[0]||(r[0]=m=>o())},null,40,ke)])):x("",!0),a("div",Se,u(e.title.slice(0,1)),1),a("div",null,[a("h4",Ce,u(e.title),1),a("small",_e,u(e.subtitle),1),a("small",Ae,u(n(Q)(e.date)),1)])]),a("div",Me,[a("div",Te,[a("h4",De,[d(R),C(" "+u(n(k)(e.value,e.currencyCode))+" ",1),e.expenses?(i(),y("span",Ee,"("+u(n(k)(e.expenses,e.currencyCode))+")",1)):x("",!0)]),a("small",Ne,u(e.status),1)]),n(g)?(i(),A(n(ee),{key:0,trigger:"click","key-field":"name",options:n(p),"on-select":$,onClick:r[1]||(r[1]=U(()=>{},["stop"]))},{default:f(()=>[Be]),_:1},8,["options"])):x("",!0)])]),e.expenses?(i(),y("div",Re,[d(n(te),{percentage:n(l),"stroke-width":1,height:"2px","border-radius":"0"},null,8,["percentage"])])):x("",!0)],2))}},Oe={class:"flex justify-between"},je={class:"flex items-center justify-end w-full"},Ie={__name:"SectionCard",props:{classes:{type:String,default:"mt-1"},cardClass:{type:String,default:"mt-2 bg-base-lvl-3 border border-base rounded-lg shadow-md"},sectionTitle:{type:String,default:""},action:{type:[Object,null]}},emits:["action"],setup(e){return(t,s)=>(i(),y("div",{class:S([e.classes,"overflow-hidden text-body-1"])},[a("div",Oe,[d(ae,{type:"secondary",class:"w-full"},{default:f(()=>[C(u(e.sectionTitle),1)]),_:1}),a("div",je,[e.action||t.$slots.action?M(t.$slots,"action",{key:0},()=>[e.action?(i(),A(n(E),{key:0,class:"flex items-center text-primary",onClick:s[0]||(s[0]=l=>t.$emit("action"))},{default:f(()=>[a("span",null,u(e.action.label),1),e.action.iconClass?(i(),y("i",{key:0,class:S(["ml-2",e.action.iconClass])},null,2)):x("",!0)]),_:1})):x("",!0)]):x("",!0)])]),a("div",{class:S([e.cardClass,"overflow-hidden border-base"])},[M(t.$slots,"default")],2)],2))}},Pe={key:0,class:"flex items-center justify-between px-4 py-5 bg-base-lvl-1 text-body-1"},Fe=a("div",{class:"font-bold"},"Selected Items sum",-1),Le={class:"space-y-1 text-right"},Ge={key:1,class:"items-center justify-center px-5 py-6 text-center text-gray-600"},Ue=a("div",{class:"mx-auto text-6xl"},[a("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"mx-auto iconify iconify--iconoir",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[a("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},[a("path",{d:"M7 2h9.5L21 6.5V19"}),a("path",{d:"M3 20.5v-14A1.5 1.5 0 0 1 4.5 5h9.752a.6.6 0 0 1 .424.176l3.148 3.148A.6.6 0 0 1 18 8.75V20.5a1.5 1.5 0 0 1-1.5 1.5h-12A1.5 1.5 0 0 1 3 20.5Z"}),a("path",{fill:"currentColor",d:"M14 8.4V5.354a.354.354 0 0 1 .604-.25l3.292 3.292a.353.353 0 0 1-.25.604H14.6a.6.6 0 0 1-.6-.6Z"})])])],-1),qe=a("span",{class:"mt-10 text-lg font-bold"}," No transactions found ",-1),He=[Ue,qe],I={__name:"TransactionsTable",props:{classes:{type:String,default:"mt-1"},tableClass:{type:String,default:"mt-2 bg-base-lvl-1 border border-base-deep-1 rounded-lg shadow-md"},tableLabel:{type:String,default:""},transactions:{type:Array,default(){return[]}},parser:{type:[Function,null],default:null},showSum:{type:Boolean,default:!1},allowMarkAsPaid:{type:Boolean,default:!1},allowMarkAsApproved:{type:Boolean,default:!1},allowRemove:{type:Boolean,default:!1},allowSelect:{type:Boolean,default:!1},allowEdit:{type:Boolean,default:!1}},emits:["update:selected","edit","paid-clicked","approved","removed"],setup(e,{emit:t}){const s=e,l=h(()=>s.parser?s.parser(s.transactions):s.transactions),o=q([]),p=r=>o.includes(r.id||r.title),g=r=>{if(s.allowSelect){const m=r.id||r.title;p(r)?o.splice(o.indexOf(m),1):o.push(m)}t("update:selected",o)},$=h(()=>w(o));h(()=>w(l.value.map(r=>r.id)));const w=r=>r.reduce((m,c)=>{const b=l.value.find(_=>_.id===c||_.title===c);return b&&(m[b.currencyCode]?m[b.currencyCode]=j.add(m[b.currencyCode],b.value):m[b.currencyCode]=j.add(0,b.value)),m},{});return(r,m)=>(i(),A(Ie,{classes:e.classes,"section-title":e.tableLabel,"card-class":e.tableClass},{action:f(()=>[M(r.$slots,"action")]),default:f(()=>[a("div",null,[n(l).length?(i(),y(N,{key:0},[(i(!0),y(N,null,V(n(l),(c,b)=>(i(),A(Ve,H(c,{"mark-as-paid":e.allowMarkAsPaid,"mark-as-approved":e.allowMarkAsApproved,"allow-remove":e.allowRemove,"allow-select":e.allowSelect,"allow-edit":e.allowEdit,key:c.id,isSelected:p(c),class:"odd:bg-base-lvl-1 even:bg-base-lvl-2",onSelected:_=>g(c),onPaidClicked:_=>r.$emit("paid-clicked",c),onApproved:_=>r.$emit("approved",c),onRemoved:_=>r.$emit("removed",c),onEdit:_=>r.$emit("edit",e.transactions[b])}),null,16,["mark-as-paid","mark-as-approved","allow-remove","allow-select","allow-edit","isSelected","onSelected","onPaidClicked","onApproved","onRemoved","onEdit"]))),128)),e.showSum?(i(),y("div",Pe,[Fe,a("div",Le,[(i(!0),y(N,null,V(n($),(c,b)=>(i(),y("div",null,u(n(k)(c,b)),1))),256))])])):x("",!0)],64)):(i(),y("div",Ge,He))])]),_:3},8,["classes","section-title","card-class"]))}},Ye={class:"relative text-sm font-bold text-blue-400"},Ze={class:"w-full ml-5 text-right"},ze={class:"font-bold"},We={class:"w-full overflow-hidden text-sm text-right block overflow-ellipsis min-w-full"},P={__name:"FinanceCard",props:{value:{type:String},title:{type:String},subtitle:{type:String},hidden:{type:Boolean}},setup(e){const t="flex bg-gray-100 items-center rounded-md px-5 py-4";return(s,l)=>(i(),y("div",{class:S(t)},[a("div",Ye,[d(R),C(" "+u(e.value),1)]),a("div",Ze,[a("p",ze,u(e.title),1),a("span",We,u(e.subtitle),1)])]))}},Xe={class:"flex justify-between"},Je=a("span",null,[a("i",{class:"fa fa-cogs"})],-1),Ke={class:"mt-2 text-lg font-bold relative"},Qe={class:"font-bold"},et={__name:"FinanceVarianceCard",props:{value:{type:String},title:{type:String},varianceTitle:{type:String},variance:{type:String},varianceAmount:{type:[String,Number]}},setup(e){const t=e,s=F(),l=W(s),o=h(()=>l.value?t.varianceAmount:`${t.variance}%`);return(p,g)=>(i(),y("div",{class:"px-5 py-5 mx-auto text-white bg-primary cursor-pointer rounded-xl",onClick:g[0]||(g[0]=$=>p.$emit("click"))},[a("header",Xe,[a("h4",null,u(e.title),1),Je]),a("div",Ke,[d(R),C(" "+u(e.value),1)]),a("div",{class:"px-5 py-2 mt-4 text-xs bg-gray-700 bg-opacity-25 rounded-3xl",ref_key:"varianceRef",ref:s},[C(u(e.varianceTitle)+": ",1),a("span",Qe,u(n(o)),1)],512)]))}},tt={class:"items-center pb-2 md:justify-between md:flex"},at={class:"font-bold text-body"},st={class:"space-x-2"},nt={class:"flex py-3"},D={__name:"WidgetTitleCard",props:{title:{type:String,required:!0}},setup(e){return(t,s)=>(i(),y("div",{class:S(["px-5 py-3 transition border divide-y rounded-lg divide-base border-base bg-base-lvl-3",t.cardShadow])},[a("div",tt,[a("h1",at,[M(t.$slots,"title",{},()=>[C(u(e.title),1)])]),a("div",st,[t.action||t.$slots.action?M(t.$slots,"action",{key:0},()=>[t.action?(i(),A(n(E),{key:0,class:"text-sm text-primary",rounded:"",onClick:s[0]||(s[0]=l=>t.$emit("action"))},{default:f(()=>[a("span",null,u(t.action.label),1),t.action.iconClass?(i(),y("i",{key:0,class:S(["ml-2",t.action.iconClass])},null,2)):x("",!0)]),_:1})):x("",!0)]):x("",!0)])]),a("div",nt,[M(t.$slots,"default")])],2))}},lt={class:"w-full"},ot={class:"flex items-center justify-between"},rt={class:"font-bold text-body-1/80"},it=a("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--ic",width:"32",height:"32",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[a("path",{fill:"currentColor",d:"M12 7C6.48 7 2 9.24 2 12c0 2.24 2.94 4.13 7 4.77V20l4-4l-4-4v2.73c-3.15-.56-5-1.9-5-2.73c0-1.06 3.04-3 8-3s8 1.94 8 3c0 .73-1.46 1.89-4 2.53v2.05c3.53-.77 6-2.53 6-4.58c0-2.76-4.48-5-10-5z"})],-1),dt=[it],ct={__name:"CategoryTrendsPreview",props:{groupData:{type:Array,default(){return[]}},categoryData:{type:Array,default(){return[]}}},setup(e){const t=e,s=F(!0),l=()=>{s.value=!s.value},o=h(()=>s.value?t.groupData:t.categoryData),p=h(()=>s.value?"Category Group":"Categories");return(g,$)=>(i(),A(D,{title:"Trends preview",action:{label:"Go to Trends",iconClass:"fa fa-chevron-right"},onAction:$[0]||($[0]=w=>g.Inertia.visit("/trends"))},{default:f(()=>[a("article",lt,[a("header",ot,[a("h4",rt,u(n(p)),1),a("button",{onClick:l,class:S(["transform animate",[!s.value&&"-rotate-180"]])},dt,2)]),d(re,{style:{height:"270px",background:"white",width:"100%"},series:n(o),label:"name",value:"total"},null,8,["series"])])]),_:1}))}},ut=C(" Import Transactions "),mt={class:"grid grid-cols-2 gap-12 mt-4"},ft={class:"flex justify-between space-x-4 overflow-hidden flex-nowrap w-full"},pt={class:"w-full mx-auto space-y-2"},vt=a("span",null," See scheduled",-1),yt=a("i",{class:"ml-2 fa fa-chevron-right"},null,-1),gt=a("i",{class:"fa fa-plus"},null,-1),ht=C(" Add transaction"),Pt={__name:"Index",props:{user:{type:Object,required:!0},planned:{type:Array,default(){return[]}},expensesByCategory:{type:Array,default(){return[]}},expensesByCategoryGroup:{type:Array,default(){return[]}},budgetTotal:{type:Number,default:0},income:{type:Number,default:0},savings:{type:Number},lastMonthIncome:{type:Number,default:0},transactionTotal:{type:Number,default:0},lastMonthExpenses:{type:Number,default:0},transactions:{type:Array,default(){return[]}},categories:{type:Array,default(){return[]}},accounts:{type:Array,default(){return[]}},serverSearchOptions:{type:Object,default:()=>({})}},setup(e){const t=e,{serverSearchOptions:s}=Y(t),{state:l}=se(s),{categoryOptions:o}=J();o(t.categories,"accounts","categoryOptions"),o(t.accounts,"accounts","accountsOptions");const p=h(()=>{try{return de(ue(l.dates.startDate,1),"MMM")}catch{return"LM"}}),g=h(()=>O(t.income,t.lastMonthIncome)),$=h(()=>O(t.transactionTotal,t.lastMonthExpenses)||0),w=t.expensesByCategory.slice(0,4);return(r,m)=>(i(),A(X,null,{header:f(()=>[d(ne,null,{actions:f(()=>[d(n(z),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",startDate:n(l).dates.startDate,"onUpdate:startDate":m[0]||(m[0]=c=>n(l).dates.startDate=c),endDate:n(l).dates.endDate,"onUpdate:endDate":m[1]||(m[1]=c=>n(l).dates.endDate=c),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["startDate","endDate"]),a("div",null,[d(K,{variant:"inverse"},{default:f(()=>[ut]),_:1})])]),_:1})]),default:f(()=>[d(le,{title:"Finance",accounts:e.accounts,ref:"financeTemplateRef"},{default:f(()=>[a("section",mt,[d(D,{title:"Summary",class:"w-full"},{default:f(()=>[a("div",ft,[a("div",pt,[d(P,{class:"text-body-1 bg-base-lvl-1",title:"Income",value:n(k)(e.income),subtitle:`${n(p)}: ${n(g)}%`},null,8,["value","subtitle"]),d(P,{class:"text-body-1 bg-base-lvl-1",title:"Savings",value:n(k)(e.savings),subtitle:`Total: ${n(k)(e.savings)}`},null,8,["value","subtitle"]),d(oe,{goal:e.budgetTotal,current:e.transactionTotal,class:"border-t h-8 rounded-b-lg text-white"},null,8,["goal","current"])]),d(et,{class:"w-full",title:"Expenses","variance-title":n(p),value:n(k)(e.transactionTotal),variance:n($),"variance-amount":n(k)(e.lastMonthExpenses),onClick:m[2]||(m[2]=c=>r.$inertia.visit("/finance/transactions"))},null,8,["variance-title","value","variance","variance-amount"])])]),_:1}),d(D,{title:"Planned Transactions",class:"hidden md:block"},{action:f(()=>[d(n(E),{class:"flex items-center text-primary",onClick:m[3]||(m[3]=c=>n(Z.Inertia).visit("/transactions?filter[status]=planned"))},{default:f(()=>[vt,yt]),_:1})]),default:f(()=>[d(I,{class:"w-full","table-class":"overflow-auto text-sm rounded-t-lg shadow-md bg-base-lvl-3 p-2 w-full",transactions:e.planned,parser:n(be),onEdit:r.handleEdit},null,8,["transactions","parser","onEdit"])]),_:1}),d(ct,{class:"w-full","category-data":n(w),"group-data":e.expensesByCategoryGroup},null,8,["category-data","group-data"]),d(D,{title:"Transactions",class:"w-full"},{action:f(()=>[d(n(E),{class:"text-primary",onClick:c=>""},{default:f(()=>[gt,ht]),_:1})]),default:f(()=>[d(I,{class:"w-full","table-class":"overflow-auto text-sm",transactions:e.transactions,parser:n(he),onEdit:c=>""},null,8,["transactions","parser"])]),_:1})])]),_:1},8,["accounts"])]),_:1}))}};export{Pt as default};
