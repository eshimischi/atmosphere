import{r as O,x as W,q as C,f as e,s as ne,u as P,B as Y,o as _,c as k,a as u,b as c,g as B,e as S,d as m,F as G,h as J,n as I,i as A,p as se,t as E,S as M,H as oe,Q as me,Z as fe,E as le,k as pe,a6 as ge,m as ve}from"./app.8c4d85cf.js";import{_ as ee,e as L,A as N,f as ye,a as V,g as be}from"./atmosphere-ui.es.4435c64a.js";import{a as re,I as ue,V as te,_ as _e}from"./FinanceTemplate.0ba09369.js";import{G as he,E as H,_ as we}from"./AppLayout.3b0489bb.js";import{m as xe,F as De,W as $e}from"./index.28d5a268.js";import{r as ke,a as Ce,f as z}from"./index.082e1a14.js";import{N as F}from"./Select.ef620d5c.js";import{_ as Q}from"./LogerInput.b9b0f9d1.js";import{f as K}from"./formatMoney.228f3112.js";import{e as q}from"./exact-math.node.76a9c4c7.js";import{_ as Se}from"./FinanceSectionNav.59ad4cb8.js";import{N as de}from"./NumberHider.639f1aa6.js";import{N as ie}from"./Popover.ad11f4ae.js";import{u as Oe}from"./useServerSearch.a3eddfc2.js";import{_ as Be}from"./_plugin-vue_export-helper.cdc0426e.js";import"./AccountModal.cc2a3479.js";import"./Modal.414ced84.js";/* empty css                                              */import"./SectionTitle.b84dbd6d.js";import"./TransactionModal.7246e40e.js";import"./DatePicker.d9ac50bf.js";import"./Suffix.dc74e16b.js";import"./light.24ffe470.js";import"./fade-in-scale-up.cssr.73ecc0f8.js";import"./ImportResourceModal.35f4cc5a.js";import"./SectionNav.a8ebaf6b.js";import"./format-length.7f3135aa.js";import"./index.a6d4cc5b.js";function X(a){ke(1,arguments);var t=Ce(a);return t.setDate(1),t.setHours(0,0,0,0),t}function T(a,t){if(t.length<a)throw new TypeError(a+" argument"+(a>1?"s":"")+" required, but only "+t.length+" present")}function R(a){T(1,arguments);var t=Object.prototype.toString.call(a);return a instanceof Date||typeof a=="object"&&t==="[object Date]"?new Date(a.getTime()):typeof a=="number"||t==="[object Number]"?new Date(a):((typeof a=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function ae(a){T(1,arguments);var t=R(a);return t.setHours(0,0,0,0),t}function Ve(a){T(1,arguments);var t=R(a);return t.setHours(23,59,59,999),t}function Ae(a){T(1,arguments);var t=R(a),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Ne(a){T(1,arguments);var t=R(a);return Ve(t).getTime()===Ae(t).getTime()}const Ee=a=>{const t=O(a.nextMode),n=s=>{const f=new Date(s.setDate(s.getDate()-4)),$=[];for(let D=0;D<7;D++)f.setDate(f.getDate()+1),$.push(ae(new Date(f)));return $},l=O(0),g=O(),x=s=>{g.value=s||g.value},y=s=>{const f=new Date(s.setDate(s.getDate()-s.getDay()+l.value)),$=[new Date(f)];for(;f.setDate(f.getDate()+1)&&f.getDay()!==l.value;){const D=new Date(new Date(f).setHours(0,0,0,0));$.push(D)}return $},p=s=>{const f=new Date(s.setDate(s.getDate()-(s.getDate()-1))),$=[new Date(f)];for(;!Ne(f);)f.setDate(f.getDate()+1),$.push(new Date(f));return $},d=s=>{const f={day:n,week:y,month:p},$=t.value||"week";return f[$](new Date(s))},r=O(),o=s=>{r.value=ae(s||r.value)};o(a.initialDate||new Date);const b=()=>{x(d(r.value))};W(r,(s,f)=>{b()},{immediate:!0}),W(t,b);const v=()=>{const s=t.value==="day"?3:g.value.length-1,f=e(g),$=new Date(f[s].setDate(f[s].getDate()+1));o($)},i=()=>{const s=t.value==="day"?3:0,f=e(g),$=new Date(f[s].setDate(f[s].getDate()-1));o($)};return{selectedDay:r,selectedSpan:g,startDate:C(()=>g.value[0]),endDate:C(()=>g.value[g.value.length-1]),controls:{setDateSpan:x,setDay:o,previous:i,next:v}}},Me={class:"flex mt-2 space-x-2"},Ie={class:"w-full h-2 bg-primary"},Ue={class:"flex justify-between mb-5"},qe={class:"flex font-bold"},Fe=A(" Delete "),Te=A(" Cancel "),je=A(" Save "),Le={__name:"BudgetItemForm",props:{isAddingGroup:{type:Boolean,default:!1},parentId:{type:Number,default:null},full:{type:Boolean,default:!1},category:{type:Object,required:!0},item:{type:Object,default:()=>{}}},setup(a){const t=a,n=ne({isAddingGroup:!1,form:P({category_id:null,parent_id:null,name:"",amount:0,assigned:0,target_type:"",frequency:"MONTHLY",frequency_month_date:null,frequency_week_day:null,frequency_date:null,frequency_interval:0,frequency_interval_unit:0}),targetTypes:[{value:"spending",label:"Spending",description:`For groceries, holidays, vacations
                Fund up to an amount with the ability to spend from it along the way
                `},{value:"saving_balance",label:"Saving Balance",description:`down payments, emergency fund
                Save this amount over time and maintain the balance by replenishing any money spent
                `},{value:"savings_monthly",label:"Savings Monthly",description:`For saving goals with unknown targets
                Contribute this amount every month until you disable this target
                `},{value:"debt_monthly_payment",label:"Debt Monthly Payment",description:`Use for: Mortgage, student loans, auto loans, etc
                Budget for payments until you are debt free
                `}],frequencies:[{value:"MONTHLY",label:"Monthly"},{value:"WEEKLY",label:"Weekly"},{value:"DATE",label:"By Date"}]}),l=C(()=>({...{MONTHLY:{field:"frequency_month_date",options:xe()},WEEKLY:{field:"frequency_week_day",options:he($e)}}[n.form.frequency]}));W(()=>t.item,()=>{t.item?Object.keys(n.form.data()).forEach(d=>{n.form[d]=t.item[d]||n.form[d]}):n.form.reset()});const g=()=>{var o,b;const r={update:{method:"put",url:((o=t.item)==null?void 0:o.id)&&`/categories/${t.category.id}/budgets/${t.item.id}`},save:{method:"post",url:`/categories/${t.category.id}/budgets`}}[(b=t.item)!=null&&b.id?"update":"save"];n.form.transform(v=>({...v,parent_id:v.parent_id||n.parentId}))[r.method](r.url,{onSuccess:()=>{n.form.reset()}})},{selectedSpan:x}=Ee({nextMode:"month"}),y=C(()=>n.form.frequency==De.WEEKLY&&x.value.filter(d=>{var r,o;return z(d,"iiiiii").toLowerCase()==((o=(r=n.form)==null?void 0:r.frequency_week_day)==null?void 0:o.toLowerCase())})),{form:p}=Y(n);return(d,r)=>(_(),k("div",{class:I(["px-5 text-left border-b",{flex:!a.full}])},[u(e(N),{label:"Name"},{default:c(()=>[u(e(ee),{modelValue:a.category.name,"onUpdate:modelValue":r[0]||(r[0]=o=>a.category.name=o)},null,8,["modelValue"]),d.errors?(_(),B(e(L),{key:0,errors:d.errors,field:"name"},null,8,["errors"])):S("",!0)]),_:1}),u(e(N),{label:"Target Type"},{default:c(()=>[u(e(F),{filterable:"",clearable:"",size:"large",value:e(p).target_type,"onUpdate:value":r[1]||(r[1]=o=>e(p).target_type=o),"default-expand-all":!0,options:n.targetTypes},null,8,["value","options"]),d.errors?(_(),B(e(L),{key:0,errors:d.errors,field:"account_id"},null,8,["errors"])):S("",!0)]),_:1}),u(e(N),{label:"Amount"},{default:c(()=>[u(e(ee),{type:"number",modelValue:e(p).amount,"onUpdate:modelValue":r[2]||(r[2]=o=>e(p).amount=o)},null,8,["modelValue"]),d.errors?(_(),B(e(L),{key:0,errors:"errors",field:"amount"})):S("",!0)]),_:1}),u(e(ye),{modelValue:e(p).frequency,"onUpdate:modelValue":r[3]||(r[3]=o=>e(p).frequency=o),options:n.frequencies,theme:"primary",class:"text-lg"},null,8,["modelValue","options"]),["MONTHLY","WEEKLY"].includes(e(p).frequency)?(_(),B(e(N),{key:0,label:"Every"},{default:c(()=>[u(e(F),{filterable:"",clearable:"",size:"large",value:e(p)[e(l).field],"onUpdate:value":r[4]||(r[4]=o=>e(p)[e(l).field]=o),"default-expand-all":!0,options:e(l).options},null,8,["value","options"]),m("div",Me,[(_(!0),k(G,null,J(e(y),o=>(_(),k("div",Ie))),256))]),d.errors?(_(),B(e(L),{key:0,errors:d.errors,field:e(l).field},null,8,["errors","field"])):S("",!0)]),_:1})):S("",!0),m("div",Ue,[m("div",qe,[u(e(V),{class:"block h-full text-red-500",onClick:r[5]||(r[5]=o=>d.$emit("delete"))},{default:c(()=>[Fe]),_:1}),u(e(V),{class:"block h-full text-gray-500",onClick:r[6]||(r[6]=o=>d.$emit("cancel"))},{default:c(()=>[Te]),_:1})]),u(e(V),{class:"block h-full text-white bg-primary",onClick:r[7]||(r[7]=o=>g())},{default:c(()=>[je]),_:1})])],2))}},Ye={class:"w-full text-right"},He={class:"flex space-x-2 justify-end items-center"},We=A("Cancel"),Ke=A(" Save"),Pe={__name:"BalanceInput",props:{value:{type:Number},formatter:{type:Function,default(){return a=>a}},category:{type:Object,required:!0}},setup(a){const t=a,n={good:"bg-success",danger:"bg-danger",needs:"bg-warning",overspend:"bg-warning",default:"bg-base-lvl-3"},l={overspent:"overspent",available:"available",empty:"empty"},g=C(()=>{if(t.value>0)return l.available;if(t.value<0)return l.overspent}),x=C(()=>{let v=n.default;return t.value>0?v=n.good:t.value<0&&(v=n.overspend),[v]}),y=P({amount:Math.abs(t.value),source_category_id:null,destination_category_id:null}),p=()=>{if(Number(t.category.budgeted)!==Number(y.amount)){const v=z(X(new Date),"yyyy-MM-dd"),i=g.value==l.available?"source_category_id":"destination_category_id";y.transform(s=>({...s,budgeted:t.category.budgeted+s.amount,[i]:t.category.id})).post(`/budgets/${t.category.id}/months/${v}`,{preserveState:!0,preserveScroll:!0})}},d=se("categoryOptions",[]),r=O(!1),o=()=>{y.reset(),r.value=!1},b=()=>{r.value=!r.value};return(v,i)=>(_(),k("div",Ye,[u(e(ie),{trigger:"manual",placement:"bottom","onUpdate:show":v.handleUpdateShow,show:r.value},{trigger:c(()=>[m("span",{class:I(["px-5 py-1 cursor-pointer rounded-3xl text-body-1",e(x)]),onClick:b},E(a.formatter(a.value)),3)]),default:c(()=>[m("div",null,[u(e(N),{label:"Move"},{default:c(()=>[u(Q,{modelValue:e(y).amount,"onUpdate:modelValue":i[0]||(i[0]=s=>e(y).amount=s)},null,8,["modelValue"])]),_:1}),e(g)==l.available?(_(),B(e(N),{key:0,label:"To"},{default:c(()=>[u(e(F),{filterable:"",clearable:"",size:"large",value:e(y).destination_category_id,"onUpdate:value":i[1]||(i[1]=s=>e(y).destination_category_id=s),"default-expand-all":!0,options:e(d)},null,8,["value","options"])]),_:1})):(_(),B(e(N),{key:1,label:"From"},{default:c(()=>[u(e(F),{filterable:"",clearable:"",size:"large",value:e(y).source_category_id,"onUpdate:value":i[2]||(i[2]=s=>e(y).source_category_id=s),"default-expand-all":!0,options:e(d)},null,8,["value","options"])]),_:1})),m("div",He,[u(e(V),{class:"text-body-1",onClick:o},{default:c(()=>[We]),_:1}),u(e(V),{class:"bg-success text-white rounded-md",onClick:i[3]||(i[3]=s=>p())},{default:c(()=>[Ke]),_:1})])])]),_:1},8,["onUpdate:show","show"])]))}},ze=(a,t=null,n)=>{a.transform(l=>({...l,resource_type:"transactions",parent_id:t})).post("/budgets",{onSuccess(){M.Inertia.reload({preserveScroll:!0}),a.reset(),oe(()=>{n&&n()})}})},Qe=a=>{const t=O([]),n=C(()=>(t.value=[],me.exports.cloneDeep(a.value).data.map(b=>{const v=Object.values(b.subCategories).reduce((i,s)=>(i.budgeted=q.add(i.budgeted,s.budgeted||0),i.spent=q.add(i.spent,s.spent||0),i.available=q.add(i.available,s.available||0),Number(s.available)<0&&(t.value.push(s),s.hasOverspent=!0,i.hasOverspent=!0),i),{budgeted:0,spent:0,available:0});return b.budgeted=v.budgeted,b.spent=v.spent,b.available=v.available,b.hasOverspent=v.hasOverspent,b}))),l=O(!1),g=O([]);W(()=>a.value,()=>{g.value=y()},{immediate:!0,deep:!0});const x=()=>{l.value=!l.value,g.value=y()};function y(){return n.value.reduce((o,b)=>{let v=b.name!="Inflow";return l.value&&(v=v&&b.hasOverspent),v&&(b.subCategories=b.subCategories.filter(i=>l.value?i.hasOverspent:!0),o.push(b)),o},[])}const p=C(()=>n.value.find(o=>o.name=="Inflow")),d=C(()=>n.value.filter(o=>o.name!="Inflow"));return{readyToAssign:C(()=>{var i;const o=d.value.reduce((s,f)=>q.add(f.budgeted,s||0),0),b=q.sub(((i=p.value)==null?void 0:i.spent)|0,o||0),v=p.value.subCategories[0];return{balance:b,...v}}),budgetState:d,visibleCategories:g,overspentCategories:t,toggleOverspent:x,overspentFilter:l}},Re={class:"flex justify-between py-2 px-4"},Ze={class:"flex items-center space-x-2"},Ge={class:"cursor-grab"},Je={class:"flex items-center space-x-2"},Xe=m("i",{class:"fa fa-plus"},null,-1),et=m("i",{class:"fa fa-ellipsis-v"},null,-1),tt={__name:"BudgetGroupItem",props:{item:{type:Object,required:!0},forceExpanded:{type:Boolean,default:!1}},emits:["removed"],setup(a,{emit:t}){const n=a,l=O(n.forceExpanded),g=C(()=>l.value?"fa-chevron-up":"fa-chevron-down");fe(()=>{n.forceExpanded&&(l.value=!0)});const x=O(!1),y=()=>x.value=!x.value,p=O();le(()=>{re(p.value)});const d=[{name:"delete",label:"Delete"}],r=()=>{confirm("Are you sure you want to remove this category group?")&&M.Inertia.delete(`budgets/${n.item.id}`,{onSuccess(){t("removed",n.item.id),M.Inertia.reload({only:["budgets"],preserveScroll:!0})}})},o=b=>{switch(b){case"delete":r();break}};return(b,v)=>(_(),k("article",null,[m("header",Re,[m("div",Ze,[m("div",Ge,[u(ue,{class:"handle"})]),u(H,{onClick:v[0]||(v[0]=i=>l.value=!l.value)},{default:c(()=>[m("i",{class:I(["fa",e(g)])},null,2)]),_:1}),m("div",null,[m("h4",null,E(a.item.name),1)])]),m("div",Je,[m("p",null,E(e(K)(a.item.spent))+" of "+E(e(K)(a.item.budgeted)),1),u(H,{onClick:y},{default:c(()=>[Xe]),_:1}),u(e(de),{trigger:"click",options:d,"key-field":"name","on-select":o},{default:c(()=>[u(H,null,{default:c(()=>[et]),_:1})]),_:1})])]),m("section",{class:"pl-4 border-l-4 border-primary bg-base",ref_key:"dropdown",ref:p},[l.value||x.value?pe(b.$slots,"content",{key:0,isExpanded:l.value,toggleAdding:y,isAdding:x.value}):S("",!0)],512)]))}},at={class:"flex px-4 py-2 space-between"},nt={class:"flex items-center w-full space-x-4"},st=m("i",{class:"fa fa-trash"},null,-1),ot=[st],lt={class:"mr-4 cursor-grab"},rt={class:"flex items-center space-x-2 text-right flex-nowrap min-w-fit"},ut=m("i",{class:"fa fa-ellipsis-v"},null,-1),dt={__name:"BudgetItem",props:{item:{type:Object,required:!0},showDelete:{type:Boolean,required:!1}},emits:["removed"],setup(a,{emit:t}){const n=a,l=O(n.item.budgeted),g=()=>{if(Number(n.item.budgeted)!==Number(l.value)){const d=z(X(new Date),"yyyy-MM-dd");M.Inertia.post(`/budgets/${n.item.id}/months/${d}`,{id:n.item.id,budgeted:l.value},{preserveState:!0,preserveScroll:!0})}},x=[{name:"delete",label:"Delete"},{name:"hide",label:"Hide"}],y=()=>{confirm("Are you sure you want to remove this category?")&&M.Inertia.delete(`budgets/${n.item.id}`,{onSuccess(){t("removed",n.item.id),M.Inertia.reload({only:["budgets"],preserveScroll:!0})}})},p=d=>{switch(d){case"delete":y();break}};return(d,r)=>(_(),k("div",at,[m("div",nt,[a.showDelete?(_(),k("button",{key:0,class:"text-gray-400 transition cursor-pointer hover:text-red-400 focus:outline-none",onClick:r[0]||(r[0]=o=>d.$emit("deleted",o))},ot)):S("",!0),m("div",lt,[u(ue,{class:"handle"})]),m("div",null,[m("h4",null,E(a.item.name),1),u(Q,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=o=>l.value=o),onBlur:g},null,8,["modelValue"])])]),m("div",rt,[u(Pe,{value:a.item.available,formatter:e(K),category:a.item},null,8,["value","formatter","category"]),u(e(de),{trigger:"click",options:x,"key-field":"name","on-select":p},{default:c(()=>[u(H,null,{default:c(()=>[ut]),_:1})]),_:1})])]))}};const it={key:0,class:"w-full m-0 p-0"},ct=A(" Cancel "),mt={__name:"BudgetGroupForm",props:{modelValue:{type:String}},emits:["save"],setup(a,{emit:t}){const n=O(!1),l=C(()=>n.value?"Save":"Add Budget Group"),g=()=>{n.value=!1},x=()=>{n.value?(t("save"),oe(()=>{n.value=!1})):n.value=!0},y=O();return le(()=>{re(y.value)}),(p,d)=>(_(),k("section",{class:"flex bg-base-lvl-3 py-2 px-4",ref_key:"formContainer",ref:y},[n.value?(_(),k("div",it,[u(Q,{value:a.modelValue,"onUpdate:modelValue":d[0]||(d[0]=r=>p.$emit("update:modelValue",r)),class:"bg-transparent border-none shadow-none",placeholder:"New Category group"},null,8,["value"])])):S("",!0),m("div",{class:I(["flex",{"w-full justify-center":!n.value}])},[n.value?(_(),B(e(V),{key:0,class:"text-body-1 font-bold",onClick:g},{default:c(()=>[ct]),_:1})):S("",!0),u(e(V),{class:I(["justify-center text-center rounded-md",[n.value?"bg-primary min-w-max text-white":"w-full"]]),onClick:x},{default:c(()=>[A(E(e(l)),1)]),_:1},8,["class"])],2)],512))}},ft=Be(mt,[["__scopeId","data-v-8f41f81e"]]),pt={class:"flex flex-col h-10 justify-center"},gt={key:0},vt=A(" Fix this "),yt={class:"flex space-x-2 justify-end items-center"},bt=A("Cancel"),_t=A(" Save"),ht={__name:"BalanceAssign",props:{value:{type:Number},formatter:{type:Function,default(){return a=>a}},category:{type:Object,required:!0}},setup(a){const t=a,n={good:"bg-success",danger:"bg-error/50",needs:"bg-warning",overspend:"bg-warning",default:"bg-base-lvl-3"},l={overspent:"overspent",available:"available",empty:"empty"},g=C(()=>{if(t.value>0)return l.available;if(t.value<0)return l.overspent}),x=C(()=>g.value==l.overspent),y=C(()=>{let i=n.default;return g.value===l.available?i=n.good:g.value===l.overspent&&(i=n.danger),[i]}),p=P({amount:Math.abs(t.value),source_category_id:null,destination_category_id:null}),d=()=>{if(Number(p.amount)>0){const i=z(X(new Date),"yyyy-MM-dd"),s=g.value==l.available?"source_category_id":"destination_category_id";p.transform(f=>({...f,budgeted:q.add(Number(t.category.budgeted),Number(f.amount)),[s]:t.category.id})).post(`/budgets/${t.category.id}/months/${i}`,{preserveState:!0,preserveScroll:!0})}},r=se("categoryOptions",[]),o=O(!1),b=()=>{p.reset(),o.value=!1},v=()=>{o.value=!o.value};return(i,s)=>(_(),k("section",{class:I(["px-5 py-1 cursor-pointer rounded-3xl text-body-1 flex justify-between",e(y)]),onClick:v},[m("article",pt,[m("p",null,E(a.formatter(a.value)),1),e(x)?(_(),k("small",gt," You assigned more than you have ")):S("",!0)]),e(x)?(_(),B(e(ie),{key:0,trigger:"manual",placement:"bottom","onUpdate:show":i.handleUpdateShow,show:o.value},{trigger:c(()=>[u(e(V),{class:"rounded-md bg-white/80"},{default:c(()=>[vt]),_:1})]),default:c(()=>[m("div",null,[u(e(N),{label:"From"},{default:c(()=>[u(e(F),{filterable:"",clearable:"",size:"large",value:e(p).source_category_id,"onUpdate:value":s[0]||(s[0]=f=>e(p).source_category_id=f),"default-expand-all":!0,options:e(r)},null,8,["value","options"])]),_:1}),m("div",yt,[u(e(V),{class:"text-body-1",onClick:b},{default:c(()=>[bt]),_:1}),u(e(V),{class:"bg-success text-white rounded-md",onClick:s[1]||(s[1]=f=>d())},{default:c(()=>[_t]),_:1})])])]),_:1},8,["onUpdate:show","show"])):S("",!0)],2))}},wt={class:"flex items-center space-x-2"},xt=A("Import Transactions"),Dt={key:0,class:"bg-info/80 items-center justify-between text-white px-2 py-2 flex"},$t=A("View categories"),kt={class:"mx-auto mt-8 rounded-lg text-body bg-base max-w-7xl"},Ct={class:"flex"},St={key:0,class:"pt-2"},aa={__name:"Budget",props:{budgets:{type:Array,required:!0},accounts:{type:Array,default(){return[]}},categories:{type:Array,required:!0},serverSearchOptions:{type:Object,default:()=>({})}},setup(a){const t=a,{serverSearchOptions:n}=Y(t),l=Oe(n),{budgets:g}=Y(t),{readyToAssign:x,visibleCategories:y,overspentCategories:p,toggleOverspent:d,overspentFilter:r}=Qe(g),o=ne({isModalOpen:!1,isAddingGroup:!0,expandedCategory:null,selectedBudget:null,budgetTotal:C(()=>0),categoryForm:P({account_id:null,parent_id:null,name:"",amount:0})}),b=D=>{M.Inertia.delete(route("budgets.destroy",D),{onSuccess:()=>{M.Inertia.reload(["budgets"])}})},v=(D,h)=>{ze(o.categoryForm,D,h)},{categoryForm:i,selectedBudget:s}=Y(o),f=D=>D==null?void 0:D.reduce((h,w)=>(h[w.id]=w,h),{}),$=D=>{const h=D.map((j,Z)=>({id:j.id,name:j.name,index:Z})),w=f(h);axios.patch("/api/categories/",{data:w})};return(D,h)=>(_(),B(we,{title:"Budget Settings",onBack:h[9]||(h[9]=w=>D.$inertia.visit(D.route("finance"))),"show-back-button":!0},{header:c(()=>[u(Se,null,{actions:c(()=>[m("div",wt,[u(e(be),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",modelValue:e(l).date,"onUpdate:modelValue":h[0]||(h[0]=w=>e(l).date=w),dateSpan:e(l).dateSpan,"onUpdate:dateSpan":h[1]||(h[1]=w=>e(l).dateSpan=w),startDate:e(l).searchOptions.date.startDate,"onUpdate:startDate":h[2]||(h[2]=w=>e(l).searchOptions.date.startDate=w),endDate:e(l).searchOptions.date.endDate,"onUpdate:endDate":h[3]||(h[3]=w=>e(l).searchOptions.date.endDate=w),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["modelValue","dateSpan","startDate","endDate"]),u(e(V),{class:"text-white rounded-md w-64 bg-primary"},{default:c(()=>[xt]),_:1})])]),_:1})]),default:c(()=>[u(_e,{accounts:a.accounts},{default:c(()=>[u(ht,{value:e(x).balance,formatter:e(K),category:e(x)},null,8,["value","formatter","category"]),e(p).length?(_(),k("div",Dt,[m("span",null,E(e(p).length)+" overspent categories ",1),u(e(V),{class:"text-info/80 bg-white rounded-md font-bold",onClick:e(d)},{default:c(()=>[$t]),_:1},8,["onClick"])])):S("",!0),m("div",kt,[m("div",Ct,[m("div",{class:I([e(s)?"w-7/12":"w-full"])},[u(ft,{modelValue:e(i).name,"onUpdate:modelValue":h[4]||(h[4]=w=>e(i).name=w),onSave:h[5]||(h[5]=w=>v())},null,8,["modelValue"]),u(e(te),{class:"w-full mt-4 space-y-2 dragArea list-group",list:e(y),handle:".handle",onEnd:h[7]||(h[7]=w=>$(e(y)))},{default:c(()=>[(_(!0),k(G,null,J(e(y),w=>(_(),B(tt,{key:w.id,item:w,"force-expanded":e(r),class:"bg-base-lvl-3"},{content:c(({isExpanded:j,isAdding:Z,toggleAdding:ce})=>[m("div",null,[Z?(_(),k("div",St,[u(Q,{placeholder:"Add subcategory",modelValue:o.categoryForm.name,"onUpdate:modelValue":h[6]||(h[6]=U=>o.categoryForm.name=U),onKeydown:ge(ve(U=>v(w.id,ce),["ctrl"]),["enter"])},null,8,["modelValue","onKeydown"])])):S("",!0),j?(_(),B(e(te),{key:1,class:"py-2 space-y-2",list:w.subCategories,handle:".handle",onEnd:U=>$(w.subCategories)},{default:c(()=>[(_(!0),k(G,null,J(w.subCategories,U=>(_(),B(dt,{class:"bg-base-lvl-2 border-base-lvl-3",key:U.id,item:U},null,8,["item"]))),128))]),_:2},1032,["list","onEnd"])):S("",!0)])]),_:2},1032,["item","force-expanded"]))),128))]),_:1},8,["list"])],2),e(s)?(_(),k("section",{key:0,class:I(["py-5 text-center",[e(s)?"w-5/12":"d-none"]])},[u(Le,{class:"mt-5",full:"",category:e(s),item:e(s).budget,onSaved:D.onBudgetItemSaved,onDeleted:b,onCancel:h[8]||(h[8]=w=>s.value=null)},null,8,["category","item","onSaved"])],2)):S("",!0)])])]),_:1},8,["accounts"])]),_:1}))}};export{aa as default};
