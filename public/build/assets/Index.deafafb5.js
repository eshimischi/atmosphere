import{q as h,o as u,c as v,d as a,e as S,t as m,f as l,a as i,i as k,g as C,b as p,m as I,n as E,s as L,k as F,F as T,h as M,y as G,r as U,B as Z,a6 as q}from"./app.cefd7668.js";import{E as z,Z as N}from"./atmosphere-ui.588c294c.js";import{_ as H,c as Y,g as R}from"./AppLayout.cd77f56f.js";import{_ as D,e as V}from"./exact-math.node.6f837759.js";import{f as _}from"./formatMoney.a91b934f.js";import{a as X}from"./index.341cb78b.js";import{N as J}from"./Dropdown.49d2a56b.js";import{N as K}from"./Progress.810b5c41.js";import{_ as j,a as Q}from"./DonutChart.b6408ba4.js";import{_ as W}from"./SectionTitle.23b660a7.js";import{u as ee,_ as te,a as ae}from"./useServerSearch.d123d8c9.js";import{_ as se}from"./BudgetProgress.a395309a.js";import"./index.4ea4832e.js";import{_ as oe}from"./LogerButton.0789417e.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.de789d8e.js";import"./Modal.a2277346.js";/* empty css                                              */import"./LogerInput.bec0734e.js";import"./index.557802c7.js";import"./ImportResourceModal.ab0a2563.js";import"./SectionNav.d2e4d6cd.js";var A,le=new Uint8Array(16);function ne(){if(!A&&(A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!A))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(le)}const re=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ie(e){return typeof e=="string"&&re.test(e)}var c=[];for(var B=0;B<256;++B)c.push((B+256).toString(16).substr(1));function de(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!ie(s))throw TypeError("Stringified UUID is invalid");return s}function ce(e,t,s){e=e||{};var n=e.random||(e.rng||ne)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){s=s||0;for(var r=0;r<16;++r)t[s+r]=n[r];return t}return de(n)}const ue=e=>e.map(t=>{var s,n,r;return{id:t.id||ce(),date:t.date,title:t.description,subtitle:(s=t.account)!=null&&s.name?`${(n=t.account)==null?void 0:n.name} -> ${(r=t.category)==null?void 0:r.name}`:"",value:t.total,status:"VERIFIED",currencyCode:t.currency_code}}),me=e=>(console.log(e,"data"),e.map(t=>{var s,n,r;return{id:t.id,date:t.date,title:t.description,subtitle:`${(s=t.account)==null?void 0:s.name} -> ${(r=(n=t.category)==null?void 0:n.name)!=null?r:""} `,value:t.total,status:"PLANNED"}})),pe={class:"flex justify-between px-5 py-2"},fe={class:"flex space-x-3"},ve={key:0,class:"flex items-center h-full"},ye=["checked"],ge={class:"flex items-center justify-center w-20 px-5 py-3 font-bold text-center transition-all rounded-md bg-base-lvl-3 group-hover:bg-primary group-hover:text-white group-body-1"},he={class:"font-bold"},be={class:"text-sm"},xe={class:"block text-sm"},we={class:"flex space-x-5"},$e={class:"text-right"},_e={class:"relative font-bold"},ke={key:0,class:"text-red-500"},Se={class:"text-sm"},Ce=a("button",{class:"hover:bg-base-lvl-3 px-2"},[a("i",{class:"fa fa-ellipsis-v"})],-1),Ae={key:0,class:"px-5"},Te={__name:"TransactionCard",props:{title:String,subtitle:String,date:String,value:String,currencyCode:String,status:String,markAsPaid:Boolean,markAsApproved:Boolean,expenses:Number,allowEdit:Boolean,allowRemove:Boolean,allowSelect:Boolean,isSelected:Boolean},emits:["selected","remove"],setup(e,{emit:t}){const s=e,n=h(()=>(Number(s.expenses||0)/Number(s.value||0)*100).toFixed(2)),r=()=>{s.allowSelect&&t("selected")},b=h(()=>[{name:"edit",label:"Edit",hide:!s.allowEdit},{name:"markAsPaid",label:"Mark as paid",hide:!s.markAsPaid},{name:"approved",label:"Approve",hide:!s.markAsApproved},{name:"removed",label:"Remove",hide:!s.allowRemove}].filter(o=>!o.hide)),w=h(()=>Object.keys(b.value).length),x=y=>{t(y)};return(y,o)=>(u(),v("div",{class:E(["transition text-slate-body group",[e.allowSelect&&"cursor-pointer hover:bg-base-lvl-3 border-2 border-transparent hover:border-primary",e.isSelected?"odd:bg-primary-100 even:bg-primary":"odd:bg-base-lvl-2 even:bg-base-lvl-1"]])},[a("div",pe,[a("div",fe,[e.allowSelect?(u(),v("div",ve,[a("input",{type:"checkbox",checked:e.isSelected,onChange:o[0]||(o[0]=d=>r())},null,40,ye)])):S("",!0),a("div",ge,m(e.title.slice(0,1)),1),a("div",null,[a("h4",he,m(e.title),1),a("small",be,m(e.subtitle),1),a("small",xe,m(l(X)(e.date)),1)])]),a("div",we,[a("div",$e,[a("h4",_e,[i(D),k(" "+m(l(_)(e.value,e.currencyCode))+" ",1),e.expenses?(u(),v("span",ke,"("+m(l(_)(e.expenses,e.currencyCode))+")",1)):S("",!0)]),a("small",Se,m(e.status),1)]),l(w)?(u(),C(l(J),{key:0,trigger:"click","key-field":"name",options:l(b),"on-select":x,onClick:o[1]||(o[1]=I(()=>{},["stop"]))},{default:p(()=>[Ce]),_:1},8,["options"])):S("",!0)])]),e.expenses?(u(),v("div",Ae,[i(l(K),{percentage:l(n),"stroke-width":1,height:"2px","border-radius":"0"},null,8,["percentage"])])):S("",!0)],2))}},Be={key:0,class:"flex items-center justify-between px-4 py-5 bg-base-lvl-1 text-body-1"},Ee=a("div",{class:"font-bold"},"Selected Items sum",-1),De={class:"space-y-1 text-right"},Me={key:1,class:"items-center justify-center px-5 py-6 text-center text-gray-600"},Ne=a("div",{class:"mx-auto text-6xl"},[a("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"mx-auto iconify iconify--iconoir",width:"1em",height:"1em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[a("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},[a("path",{d:"M7 2h9.5L21 6.5V19"}),a("path",{d:"M3 20.5v-14A1.5 1.5 0 0 1 4.5 5h9.752a.6.6 0 0 1 .424.176l3.148 3.148A.6.6 0 0 1 18 8.75V20.5a1.5 1.5 0 0 1-1.5 1.5h-12A1.5 1.5 0 0 1 3 20.5Z"}),a("path",{fill:"currentColor",d:"M14 8.4V5.354a.354.354 0 0 1 .604-.25l3.292 3.292a.353.353 0 0 1-.25.604H14.6a.6.6 0 0 1-.6-.6Z"})])])],-1),Re=a("span",{class:"mt-10 text-lg font-bold"}," No transactions found ",-1),Ve=[Ne,Re],O={__name:"TransactionsTable",props:{classes:{type:String,default:"mt-1"},tableClass:{type:String,default:"mt-2 bg-base-lvl-1 border border-base-deep-1 rounded-lg shadow-md"},tableLabel:{type:String,default:""},transactions:{type:Array,default(){return[]}},parser:{type:[Function,null],default:null},showSum:{type:Boolean,default:!1},allowMarkAsPaid:{type:Boolean,default:!1},allowMarkAsApproved:{type:Boolean,default:!1},allowRemove:{type:Boolean,default:!1},allowSelect:{type:Boolean,default:!1},allowEdit:{type:Boolean,default:!1}},emits:["update:selected","edit","paid-clicked","approved","removed"],setup(e,{emit:t}){const s=e,n=h(()=>s.parser?s.parser(s.transactions):s.transactions),r=L([]),b=o=>r.includes(o.id||o.title),w=o=>{if(s.allowSelect){const d=o.id||o.title;b(o)?r.splice(r.indexOf(d),1):r.push(d)}t("update:selected",r)},x=h(()=>y(r));h(()=>y(n.value.map(o=>o.id)));const y=o=>o.reduce((d,f)=>{const g=n.value.find($=>$.id===f||$.title===f);return g&&(d[g.currencyCode]?d[g.currencyCode]=V.add(d[g.currencyCode],g.value):d[g.currencyCode]=V.add(0,g.value)),d},{});return(o,d)=>(u(),C(j,{classes:e.classes,"section-title":e.tableLabel,"card-class":e.tableClass},{action:p(()=>[F(o.$slots,"action")]),default:p(()=>[a("div",null,[l(n).length?(u(),v(T,{key:0},[(u(!0),v(T,null,M(l(n),(f,g)=>(u(),C(Te,G(f,{"mark-as-paid":e.allowMarkAsPaid,"mark-as-approved":e.allowMarkAsApproved,"allow-remove":e.allowRemove,"allow-select":e.allowSelect,"allow-edit":e.allowEdit,key:f.id,isSelected:b(f),class:"odd:bg-base-lvl-1 even:bg-base-lvl-2",onSelected:$=>w(f),onPaidClicked:$=>o.$emit("paid-clicked",f),onApproved:$=>o.$emit("approved",f),onRemoved:$=>o.$emit("removed",f),onEdit:$=>o.$emit("edit",e.transactions[g])}),null,16,["mark-as-paid","mark-as-approved","allow-remove","allow-select","allow-edit","isSelected","onSelected","onPaidClicked","onApproved","onRemoved","onEdit"]))),128)),e.showSum?(u(),v("div",Be,[Ee,a("div",De,[(u(!0),v(T,null,M(l(x),(f,g)=>(u(),v("div",null,m(l(_)(f,g)),1))),256))])])):S("",!0)],64)):(u(),v("div",Me,Ve))])]),_:3},8,["classes","section-title","card-class"]))}},Oe={class:"relative text-sm font-bold text-blue-400"},Pe={class:"w-full ml-5 text-right"},je={class:"font-bold"},Ie={class:"w-full overflow-hidden text-sm text-right flex-block overflow-ellipsis flex-nowrap"},P={__name:"FinanceCard",props:{value:{type:String},title:{type:String},subtitle:{type:String},hidden:{type:Boolean}},setup(e){const t="flex bg-gray-100 items-center rounded-md px-5 py-4";return(s,n)=>(u(),v("div",{class:E(t)},[a("div",Oe,[i(D),k(" "+m(e.value),1)]),a("div",Pe,[a("p",je,m(e.title),1),a("span",Ie,m(e.subtitle),1)])]))}},Le={class:"flex justify-between"},Fe=a("span",null,[a("i",{class:"fa fa-cogs"})],-1),Ge={class:"mt-2 text-2xl font-bold relative"},Ue={class:"px-5 py-2 mt-4 bg-gray-700 bg-opacity-25 rounded-3xl"},Ze={class:"font-bold"},qe={__name:"FinanceVarianceCard",props:{value:{type:String},title:{type:String},varianceTitle:{type:String},variance:{type:String}},setup(e){return(t,s)=>(u(),v("div",{class:"px-5 py-5 mx-auto text-white bg-primary cursor-pointer rounded-xl",onClick:s[0]||(s[0]=n=>t.$emit("click"))},[a("header",Le,[a("h4",null,m(e.title),1),Fe]),a("div",Ge,[i(D),k(" "+m(e.value),1)]),a("div",Ue,[k(m(e.varianceTitle)+": ",1),a("span",Ze,m(e.variance)+"%",1)])]))}},ze={class:"flex px-4 py-4 items-center justify-between"},He={class:"font-bold text-body-1/80"},Ye=a("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true",role:"img",class:"iconify iconify--ic",width:"32",height:"32",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[a("path",{fill:"currentColor",d:"M12 7C6.48 7 2 9.24 2 12c0 2.24 2.94 4.13 7 4.77V20l4-4l-4-4v2.73c-3.15-.56-5-1.9-5-2.73c0-1.06 3.04-3 8-3s8 1.94 8 3c0 .73-1.46 1.89-4 2.53v2.05c3.53-.77 6-2.53 6-4.58c0-2.76-4.48-5-10-5z"})],-1),Xe=[Ye],Je={__name:"CategoryTrendsPreview",props:{groupData:{type:Array,default(){return[]}},categoryData:{type:Array,default(){return[]}}},setup(e){const t=e,s=U(!0),n=()=>{s.value=!s.value},r=h(()=>s.value?t.groupData:t.categoryData),b=h(()=>s.value?"Category Group":"Categories");return(w,x)=>(u(),C(j,{"section-title":"Trends preview",action:{label:"Go to Trends",iconClass:"fa fa-chevron-right"},onAction:x[0]||(x[0]=y=>w.Inertia.visit("/trends"))},{default:p(()=>[a("article",null,[a("header",ze,[a("h4",He,m(l(b)),1),a("button",{onClick:n,class:E(["transform animate",[!s.value&&"-rotate-180"]])},Xe,2)]),i(Q,{style:{height:"270px",background:"white",width:"100%"},series:l(r),label:"name",value:"total"},null,8,["series"])])]),_:1}))}},Ke=k(" Import Transactions "),Qe={class:"flex flex-wrap md:flex-nowrap md:space-x-8"},We={class:"w-full md:w-7/12"},et={class:"mt-5"},tt=k("Summary"),at={class:"flex justify-between px-4 py-5 mt-3 space-x-4 overflow-hidden border shadow-sm flex-nowrap border-base bg-base-lvl-3 rounded-xl"},st={class:"w-full mx-auto space-y-2"},ot={class:"hidden md:block md:w-5/12"},lt=a("span",null," See scheduled",-1),nt=a("i",{class:"ml-2 fa fa-chevron-right"},null,-1),rt={class:"flex flex-wrap mt-5 md:flex-nowrap md:space-x-8"},it={class:"w-full md:w-7/12"},dt={class:"w-full md:w-5/12"},ct=a("i",{class:"fa fa-plus"},null,-1),ut=k(" Add transaction"),Rt={__name:"Index",props:{user:{type:Object,required:!0},planned:{type:Array,default(){return[]}},expensesByCategory:{type:Array,default(){return[]}},expensesByCategoryGroup:{type:Array,default(){return[]}},budgetTotal:{type:Number,default:0},income:{type:Number,default:0},savings:{type:Number},lastMonthIncome:{type:Number,default:0},transactionTotal:{type:Number,default:0},lastMonthExpenses:{type:Number,default:0},transactions:{type:Array,default(){return[]}},categories:{type:Array,default(){return[]}},accounts:{type:Array,default(){return[]}},serverSearchOptions:{type:Object,default:()=>({})}},setup(e){const t=e,{serverSearchOptions:s}=Z(t),{state:n}=ee(s),{categoryOptions:r}=Y();r(t.categories,"accounts","categoryOptions"),r(t.accounts,"accounts","accountsOptions");const b=h(()=>R(t.income,t.lastMonthIncome)),w=h(()=>R(t.transactionTotal,t.lastMonthExpenses)||0),x=t.expensesByCategory.slice(0,4);return(y,o)=>(u(),C(H,null,{header:p(()=>[i(te,null,{actions:p(()=>[i(l(z),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",startDate:l(n).dates.startDate,"onUpdate:startDate":o[0]||(o[0]=d=>l(n).dates.startDate=d),endDate:l(n).dates.endDate,"onUpdate:endDate":o[1]||(o[1]=d=>l(n).dates.endDate=d),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["startDate","endDate"]),a("div",null,[i(oe,{variant:"inverse"},{default:p(()=>[Ke]),_:1})])]),_:1})]),default:p(()=>[i(ae,{title:"Finance",accounts:e.accounts,ref:"financeTemplateRef"},{default:p(()=>[a("section",null,[a("div",Qe,[a("div",We,[a("div",et,[i(W,{type:"secondary"},{default:p(()=>[tt]),_:1})]),a("div",at,[a("div",st,[i(P,{class:"text-body-1 bg-base-lvl-1",title:"Income",value:l(_)(e.income),subtitle:`Last Month: ${l(b)}%`},null,8,["value","subtitle"]),i(P,{class:"text-body-1 bg-base-lvl-1",title:"Savings",value:l(_)(e.savings),subtitle:`Total: ${l(_)(e.savings)}`},null,8,["value","subtitle"]),i(se,{goal:e.budgetTotal,current:e.transactionTotal,class:"border-t h-8 rounded-b-lg text-white"},null,8,["goal","current"])]),i(qe,{class:"w-full",title:"Expenses","variance-title":"Last month",value:l(_)(e.transactionTotal),variance:l(w),onClick:o[2]||(o[2]=d=>y.$inertia.visit("/finance/transactions"))},null,8,["value","variance"])])]),a("div",ot,[i(O,{"table-label":"Planned Transactions",class:"pt-3 mt-5","table-class":"overflow-auto text-sm rounded-t-lg shadow-md bg-base-lvl-3 p-2 border",transactions:e.planned,parser:l(me),onEdit:y.handleEdit},{action:p(()=>[i(l(N),{class:"flex items-center text-primary",onClick:o[3]||(o[3]=d=>l(q.Inertia).visit("/transactions?filter[status]=planned"))},{default:p(()=>[lt,nt]),_:1})]),_:1},8,["transactions","parser","onEdit"])])]),a("div",rt,[a("div",it,[i(Je,{"category-data":l(x),"group-data":e.expensesByCategoryGroup},null,8,["category-data","group-data"])]),a("div",dt,[i(O,{"table-label":"Transactions",class:"pt-3 mt-5","table-class":"overflow-auto text-sm rounded-t-lg shadow-md bg-base-lvl-3 p-2 border",transactions:e.transactions,parser:l(ue),onEdit:d=>""},{action:p(()=>[i(l(N),{class:"text-primary",onClick:d=>""},{default:p(()=>[ct,ut]),_:1})]),_:1},8,["transactions","parser"])])])])]),_:1},8,["accounts"])]),_:1}))}};export{Rt as default};
