import{L as I}from"./atmosphere-ui-b819c890.js";import{r as D,q as c,B as N,C as L,K as j,o as m,c as v,w as n,O as o,a as r,b as E,g as h,i as y,u as s,m as F,e as U,f as R,D as q}from"./app-114b751b.js";import{_ as K,I as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-c7e24bdb.js";import{_ as z}from"./TransactionSearch-04d8ffdc.js";import{u as G,_ as H,F as J}from"./useServerSearch-55d027ef.js";import{_ as P,a as Q}from"./DraftButtons-c9fef7c0.js";import{_ as X}from"./LogerButton-7d66d0a8.js";import{u as Y}from"./isMobile-e3872359.js";import{_ as Z}from"./StatusButtons-c1cd28d1.js";import{a as tt}from"./useFirebase-fe12e715.js";import"./formatMoney-75af80f0.js";import"./AppIcon-f342d706.js";/* empty css                                                */import"./Modal-c2871cdd.js";/* empty css                                              */import"./LogerInput-8ca4e824.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./TransactionsTable-abfea9c2.js";import"./exact-math.node-ab123f44.js";import"./NumberHider-49c0aef0.js";import"./index-2052210e.js";import"./Progress-446b78be.js";import"./Dropdown-839d2ecf.js";import"./SectionTitle-20b8f2ca.js";import"./vue-draggable-next.esm-bundler-3a2dc928.js";import"./constants-cb26b0c1.js";import"./WidgetCard-f1e3a88f.js";import"./SectionNav-dd96bdd5.js";import"./CustomTable-970a440a.js";const et={class:"flex items-center w-full space-x-2"},Vt={__name:"Transactions",props:{transactions:{type:Object,default:()=>({data:[]})},accounts:{type:Array,default:()=>[]},categories:{type:Array,default(){return[]}},serverSearchOptions:{type:Object,default:()=>({})},accountId:{type:[Number,null]}},setup(p){var _;const k=p,i=tt(),f=D(!1),u=c(()=>i.isMobile?f.value:!0),x=c(()=>i.isMobile?z:P),S=c(()=>i.isMobile?u.value?"All transactions":"Accounts":"Transactions"),w=()=>{if(i.isMobile&&u.value){f.value=!1;return}return o.visit(route("finance"))},{serverSearchOptions:l}=N(k),{state:d,executeSearchWithDelay:T}=G(l,{manual:!0}),$=c(()=>{var t;return(t=l.value.filters)==null?void 0:t.account_id});L("selectedAccountId",$.value);const A=c(()=>{var t;return((t=l.value.filters)==null?void 0:t.status)=="draft"}),B=t=>{o.delete(`/transactions/${t.id}`,{onSuccess(){o.reload()}})},C=t=>{o.patch(`/transactions/${t.id}/linked`,{onSuccess(){o.reload()}})},{openTransactionModal:g}=Y(),V=t=>{g({transactionData:t})},M={verified:{label:"Verified",value:"/finance/transactions?"},scheduled:{label:"Scheduled",value:"/finance/transactions?filter[status]=scheduled"},draft:{label:"Drafts",value:"/finance/transactions?filter[status]=draft&relationships=linked"}},b=D(((_=l.value.filters)==null?void 0:_.status)||"verified");return(t,e)=>{const O=j("ripple");return m(),v(K,{title:S.value,onBack:w,"show-back-button":!0},{header:n(()=>[r(H,null,{actions:n(()=>[E("div",et,[A.value?(m(),v(Q,{key:0})):h("",!0),r(X,{variant:"inverse"},{default:n(()=>[y(" Add transaction ")]),_:1}),r(Z,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),statuses:M,onChange:e[1]||(e[1]=a=>s(o).visit(a))},null,8,["modelValue"]),r(s(I),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",startDate:s(d).dates.startDate,"onUpdate:startDate":e[2]||(e[2]=a=>s(d).dates.startDate=a),endDate:s(d).dates.endDate,"onUpdate:endDate":e[3]||(e[3]=a=>s(d).dates.endDate=a),onChange:e[4]||(e[4]=a=>s(T)(500)),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["startDate","endDate"])])]),_:1})]),default:n(()=>[r(J,{title:"Transactions",accounts:p.accounts,"force-show-panel":!u.value},F({default:n(()=>[u.value?(m(),v(q(x.value),{key:0,transactions:p.transactions.data,"server-search-options":s(l),"all-accounts":"",onFindLinked:C,onRemoved:B,onEdit:V},null,40,["transactions","server-search-options"])):h("",!0)]),_:2},[s(i).isMobile?{name:"prepend-panel",fn:n(()=>[U((m(),R("button",{class:"flex items-center justify-between w-full px-4 py-3 font-bold text-body-1 bg-base-lvl-3",onClick:e[5]||(e[5]=a=>f.value=!0)},[y(" All accounts "),r(W,{class:"transform rotate-180"})])),[[O]])]),key:"0"}:void 0]),1032,["accounts","force-show-panel"])]),_:1},8,["title"])}}};export{Vt as default};
