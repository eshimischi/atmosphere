import{_ as $}from"./Modal.50d5072f.js";import{h as W,W as R,D as x,c as S,p as I,A as z,v as A,o as p,k as h,w as s,b as d,a as v,e as q,u as e,y as B,t as H,F as L,g as M,d as l,i as b,f as T}from"./app.c4e32cc5.js";import{b as u,_ as N}from"./atmosphere-ui.es.343f9b42.js";import{_ as C}from"./LogerInput.af2cdea3.js";import{N as E}from"./DatePicker.17201242.js";import{N as y}from"./Select.b9cc5204.js";import{f as P}from"./index.2e08e1eb.js";const Y={class:"pb-4 bg-slate-600 sm:p-6 sm:pb-4 text-gray-200"},j={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},F={class:"grid grid-cols-3 overflow-hidden text-lg rounded-lg"},K=["options","onClick"],X={class:"mt-2"},Z={class:"flex space-x-2"},G={class:"flex space-x-3"},J={key:0},Q={class:"flex"},ee={class:"flex"},te={class:"px-6 py-4 space-x-3 text-right bg-slate-700"},ae=T(" Cancel "),le=T(" Save "),me={props:{show:{default:!1},maxWidth:{default:"2xl"},closeable:{default:!0},categories:{type:Array,default:[]},accounts:{type:Array,default:[]},recurrence:{type:Boolean,default:!1},transactionData:{type:Object,default:()=>({})}},setup(m){const c=m,i=W({transactionTypes:[{value:"DEPOSIT",label:"Income"},{value:"WITHDRAW",label:"Expense"},{value:"ENTRY",label:"Transaction"}],frequencyLabel:"every",schedule_settings:{end_date:null,count:null,end_type:"NEVER",final_item_date:null,interval:1,frequency:"monthly",repeat_at_end_of_month:!1,repeat_on_day_of_month:null,start_date:null,timezone_id:"America/Santo_Domingo"},form:R({name:"",payee:"",date:null,description:"",direction:"WITHDRAW",category_id:null,account_id:null,display_id:"",total:0})}),w=x("categoryOptions",[]),k=x("accountsOptions",[]),U=S(()=>i.form.direction=="ENTRY"?k:w),D=async r=>{typeof r=="string"&&(category=await axios.post("/api/categories",{name:r,parent_id:"expenses"},{onSuccess:({data:t})=>t}))},O=()=>{const r={transaction:{save:{method:"post",url:()=>route("transactions.store")},update:{method:"put",url:()=>route("transactions.update",c.transactionData)}},recurrence:{save:{url:()=>route("budget.planned-transaction")}}},t=c.transactionData&&c.transactionData.id?"update":"save",g=c.recurrence?"recurrence":"transaction",_=r[g][t];i.form.transform(f=>({...f,resource_type_id:"MANUAL",total:f.total,date:P(new Date(f.date),"yyyy-MM-dd"),status:"verified",...i.schedule_settings})).submit(_.method,_.url(),{onSuccess:()=>{emit("close"),i.form.reset()}})};I(()=>c.transactionData,r=>{Object.keys(i.form.data()).forEach(t=>{t=="date"?i.form[t]=new Date(r[t]):i.form[t]=r[t]})},{deep:!0});const{form:o,schedule_settings:n,transactionTypes:V}=z(i);return(r,t)=>{const g=A("n-auto-complete"),_=A("AtInput");return p(),h($,{show:m.show,"max-width":m.maxWidth,closeable:m.closeable,onClose:t[11]||(t[11]=f=>r.$emit("update:show",!1))},{default:s(({close:f})=>[d("div",Y,[d("div",j,[d("div",F,[(p(!0),v(L,null,q(e(V),a=>(p(),v("div",{key:a.value,options:e(V),onClick:se=>e(o).direction=a.value,class:B(["py-1 font-bold text-center cursor-pointer hover:bg-slate-400",[e(o).direction==a.value?"bg-pink-500 hover:bg-pink-500 text-white":"text-gray-200 bg-slate-500"]])},H(a.label),11,K))),128))]),d("div",X,[M(r.$slots,"content",{},()=>[d("div",null,[d("div",Z,[l(e(u),{label:"Date",class:"w-3/12"},{default:s(()=>[l(e(E),{value:e(o).date,"onUpdate:value":t[0]||(t[0]=a=>e(o).date=a),type:"date",size:"large"},null,8,["value"])]),_:1}),l(e(u),{label:"Description",class:"w-5/12"},{default:s(()=>[l(C,{modelValue:e(o).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(o).description=a)},null,8,["modelValue"])]),_:1}),l(e(u),{label:"Account",class:"w-4/12"},{default:s(()=>[l(e(y),{filterable:"",clearable:"",tag:"",size:"large",value:e(o).account_id,"onUpdate:value":[t[2]||(t[2]=a=>e(o).account_id=a),D],"default-expand-all":!0,options:e(k)},null,8,["value","options"])]),_:1})]),d("div",G,[l(e(u),{label:"Payee",class:"w-5/12"},{default:s(()=>[l(g,{value:e(o).payee,"onUpdate:value":t[3]||(t[3]=a=>e(o).payee=a),"input-props":{autocomplete:"disabled"},options:r.options,placeholder:"Payee"},null,8,["value","options"])]),_:1}),l(e(u),{label:"Category",class:"w-full"},{default:s(()=>[l(e(y),{filterable:"",clearable:"",tag:"",size:"large",value:e(o).category_id,"onUpdate:value":[t[4]||(t[4]=a=>e(o).category_id=a),D],"default-expand-all":!0,options:e(U)},null,8,["value","options"])]),_:1}),l(e(u),{label:"Amount",class:"w-4/12"},{default:s(()=>[l(C,{type:"number",modelValue:e(o).total,"onUpdate:modelValue":t[5]||(t[5]=a=>e(o).total=a)},null,8,["modelValue"])]),_:1})])]),m.recurrence?(p(),v("div",J,[d("div",Q,[l(e(u),{label:"Repeat this transaction",class:"w-full"},{default:s(()=>[l(e(y),{value:e(n).frequency,"onUpdate:value":t[6]||(t[6]=a=>e(n).frequency=a),options:[{value:"WEEKLY",label:"Weekly"},{value:"MONTHLY",label:"Monthly"}]},null,8,["value"])]),_:1}),l(e(u),{label:"frequencyLabel"},{default:s(()=>[l(_,{type:"number",modelValue:e(n).repeat_on_day_of_month,"onUpdate:modelValue":t[7]||(t[7]=a=>e(n).repeat_on_day_of_month=a)},null,8,["modelValue"])]),_:1})]),d("div",ee,[l(e(u),{label:"Ends",class:"w-full"},{default:s(()=>[l(e(y),{value:e(n).end_type,"onUpdate:value":t[8]||(t[8]=a=>e(n).end_type=a),options:[{value:"NEVER",label:"Never"},{value:"DATE",label:"At"},{value:"COUNT",label:"After"}]},null,8,["value"])]),_:1}),e(n).end_type=="DATE"?(p(),h(e(u),{key:0,label:"Date"},{default:s(()=>[l(e(E),{value:e(n).end_date,"onUpdate:value":t[9]||(t[9]=a=>e(n).end_date=a),size:"lg"},null,8,["value"])]),_:1})):b("",!0),e(n).end_type=="COUNT"?(p(),h(e(u),{key:1,label:"Instances"},{default:s(()=>[l(_,{type:"number",modelValue:e(n).count,"onUpdate:modelValue":t[10]||(t[10]=a=>e(n).count=a)},null,8,["modelValue"])]),_:1})):b("",!0)])])):b("",!0)])])])]),d("div",te,[l(e(N),{type:"secondary",onClick:f,rounded:"",class:"h-10"},{default:s(()=>[ae]),_:2},1032,["onClick"]),l(e(N),{class:"text-white bg-pink-400 h-10",onClick:O,rounded:""},{default:s(()=>[le]),_:1})])]),_:3},8,["show","max-width","closeable"])}}},oe={key:0,class:"absolute rounded-md h-full w-full bg-white/30 backdrop-blur-xl"},fe={setup(m){const c=x("hasHiddenValues");return(i,w)=>e(c)?(p(),v("div",oe)):b("",!0)}};export{fe as _,me as a};
