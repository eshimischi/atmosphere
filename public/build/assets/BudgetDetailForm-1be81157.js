import{C as P,B as F,q as j,I as R,Z as M}from"./atmosphere-ui-5b718e83.js";import{p,o as i,e as y,a as r,w as c,b as o,I as O,F as I,h as Y,u as n,i as h,t as w,n as U,x as Z,T as z,J as H,A as J,K as Q,d as G,c as E,g as k}from"./app-fc313f38.js";import{N as X,f as N,e as A}from"./isMobile-3d69cdae.js";import{f as ee,p as L,_ as V}from"./formatMoney-da670e0a.js";import{a as te}from"./budgetTotals-2f07245c.js";import{t as ae,a as ne,f as re,d as le,g as W,m as oe,F as se,W as ie}from"./index-3a6f8c36.js";import{a as K,m as ue}from"./useServerSearch-8502c7d2.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";import"./exact-math.node-672740b8.js";import{_ as ce}from"./BudgetProgress-c999bebd.js";import{N as me}from"./Dropdown-1335b583.js";import{N as fe}from"./AppLayout.vue_vue_type_script_setup_true_lang-87835da0.js";import{I as ye}from"./IconClose-f76962aa.js";const ge={class:"grid grid-cols-5 gap-1"},pe=["onClick"],ve={__name:"ColorSelector",props:{modelValue:{type:String}},setup(e){const b=e,t=["#037F4C","#00C875","#9CD326","#CAB641","#FFCB00","#784BD1","#A25DDC","#0086C0","#579BFC","#66CCFF","#BB3354","#E2445C","#FF158A","#FF5AC4","#FF642E","#7F5347","#C4C4C4","#808080"];p(()=>b.modelValue||t[0]);const a=p(()=>({backgroundColor:b.modelValue||t[0]}));return(v,f)=>(i(),y("div",null,[r(n(X),{trigger:"click"},{trigger:c(()=>[o("div",{class:"w-4 h-4 rounded-sm cursor-pointer",style:O(a.value)},null,4)]),default:c(()=>[o("div",ge,[(i(),y(I,null,Y(t,l=>o("div",{class:"w-4 h-4 border border-transparent rounded-sm cursor-pointer hover:border-slate-400",style:O({backgroundColor:l}),key:l,onClick:g=>v.$emit("update:modelValue",l)},null,12,pe)),64))])]),_:1})]))}},be={name:"IcBaselineOutlinedFlag"},he={width:"1em",height:"1em",viewBox:"0 0 24 24"},_e=o("path",{fill:"currentColor",d:"m14 6l-1-2H5v17h2v-7h5l1 2h7V6h-6zm4 8h-4l-1-2H7V6h5l1 2h5v6z"},null,-1),Ce=[_e];function $e(e,b,t,a,v,f){return i(),y("svg",he,Ce)}const xe=de(be,[["render",$e]]),D=e=>e.target_type=="spending",we=e=>e.target_type=="saving_balance",ke=[{value:"spending",label:"Spending",description:`For groceries, holidays, vacations
        Fund up to an amount with the ability to spend from it along the way
        `},{value:"saving_balance",label:"Saving Balance",description:`down payments, emergency fund
        Save this amount over time and maintain the balance by replenishing any money spent
        `},{value:"savings_monthly",label:"Savings Monthly",description:`For saving goals with unknown targets
        Contribute this amount every month until you disable this target
        `},{value:"debt_monthly_payment",label:"Debt Monthly Payment",description:`Use for: Mortgage, student loans, auto loans, etc
        Budget for payments until you are debt free
        `}],qe=[{value:"MONTHLY",label:"Monthly"},{value:"WEEKLY",label:"Weekly"},{value:"DATE",label:"By Date"}],Ee={class:"flex justify-between"},$={__name:"BudgetMoneyLine",props:{title:{type:String},value:{type:[String,Number]}},setup(e){return(b,t)=>(i(),y("p",Ee,[h(w(e.title)+" ",1),r(K,{bold:"",value:e.value},null,8,["value"])]))}},Be={class:"w-full"},Te={class:"flex justify-between w-full mb-8"},Fe={class:"text-lg font-bold text-primary"},Se={class:"mb-1 font-bold"},De={class:"flex justify-between w-full mt-1"},Ve={class:"mt-4"},Me={key:0},Oe={key:1},Ne={__name:"BudgetTargetCard",props:{category:{type:Object,required:!0},item:{type:Object,default:()=>{}}},emits:["edit"],setup(e,{emit:b}){const t=e,a=p(()=>t.item.frequency_month_date==-1?"End of month":t.item.frequency_month_date?`The ${ae(t.item.frequency_month_date)}`:ne(t.item.frequency_date));function v(){return t.item.frequency_date?le(L(t.item.frequency_date),L(t.category.month)):1}const f=p(()=>D(t.item)?t.item.amount:t.item.amount/v()),l=p(()=>{if(D(t.item)){const{available:x,budgeted:_}=t.category;return x>_?x:_}else return t.category.available}),g=p(()=>f.value-l.value),q=p(()=>g.value<=0),m=p(()=>q.value?"bg-success":"bg-warning"),S=p(()=>q.value?"bg-success/10 text-success border-success":"bg-warning/10 text-warning border-warning"),B=p(()=>D(t.item)?"Funded":"Saved");return(x,_)=>(i(),y("div",Be,[o("header",Te,[o("h4",Fe,[h(" Target: "),o("p",null,w(e.item.target_type),1)]),o("button",{class:"text-secondary",onClick:_[0]||(_[0]=u=>x.$emit("edit"))}," Edit target ")]),r(ce,{class:"h-1.5 rounded-sm",goal:e.item.amount,current:l.value,"progress-class":[m.value,"bg-secondary/5"],"show-labels":!1},{before:c(()=>[o("header",Se,w(n(ee)(e.item.amount))+" by "+w(a.value),1)]),after:c(({progress:u})=>[o("div",De,[o("span",null,w(u)+"% Funded ",1),o("span",null," Started "+w(n(re)(e.item.created_at,"MMMM, yyyy")),1)])]),_:1},8,["goal","current","progress-class"]),o("footer",Ve,[o("div",{class:U(["px-5 py-2 my-4 border-2 rounded-md",S.value])},[q.value?(i(),y("span",Oe," You're on track to reach your target! ")):(i(),y("span",Me,[h(" Assign "),r(K,{value:g.value},null,8,["value"]),h(" more to reach your target ")]))],2),r($,{title:"Total needed",value:e.item.amount},null,8,["value"]),r($,{title:B.value,value:e.category.available},null,8,["title","value"]),r($,{title:"To go",value:e.item.amount-e.category.available},null,8,["value"])])]))}},Ae={class:"text-left border-b rounded-md bg-base-lvl-3 pb-4"},Le={class:"mr-2"},je={key:1},Ie=o("span",{class:"flex items-center pl-2"}," RD$ ",-1),Ye=o("i",{class:"fa fa-ellipsis-v"},null,-1),Ue={key:0},ze={class:"flex mt-2 space-x-2"},He={class:"flex justify-between mt-4"},We={class:"flex font-bold"},Ke={__name:"BudgetTargetForm",props:{parentId:{type:Number,default:null},full:{type:Boolean,default:!1},category:{type:Object,required:!0},item:{type:Object,default:()=>{}}},emits:["cancel","deleted"],setup(e,{emit:b}){const t=e,a=Z({form:z({category_id:null,parent_id:null,color:W(),name:t.category.name,amount:0,assigned:0,target_type:"",frequency:"MONTHLY",frequency_month_date:null,frequency_week_day:null,frequency_date:null,frequency_interval:0,frequency_interval_unit:0}),isEditing:!1,hasTarget:!!t.item}),v=p(()=>({...{MONTHLY:{field:"frequency_month_date",options:oe()},WEEKLY:{field:"frequency_week_day",options:ue(ie)}}[a.form.frequency]}));H(()=>t.category,()=>{t.item?(a.form.reset(),Object.keys(a.form.data()).forEach(u=>{a.form[u]=t.item[u]||""}),a.hasTarget=!0):(a.hasTarget=!1,a.form.reset())},{deep:!0,immediate:!0});const f=()=>{var C,d;const s={update:{method:"put",url:((C=t.item)==null?void 0:C.id)&&`/budgets/${t.category.id}/targets/${t.item.id}`},save:{method:"post",url:`/budgets/${t.category.id}/targets`}}[(d=t.item)!=null&&d.id?"update":"save"];a.form.transform(T=>({...T,frequency_date:T.frequency_date&&N(new Date(T.frequency_date),"yyyy-MM-dd"),parent_id:T.parent_id||a.parentId}))[s.method](s.url,{preserveScroll:!0,onSuccess(){a.isEditing=!1}})},l=()=>{a.isEditing=!1,a.hasTarget&&b("cancel")},{selectedSpan:g}=te({nextMode:"month"}),q=p(()=>a.form.frequency==se.WEEKLY&&g.value.filter(u=>{var s,C;return N(u,"iiiiii").toLowerCase()==((C=(s=a.form)==null?void 0:s.frequency_week_day)==null?void 0:C.toLowerCase())})),{form:m}=J(a),S=[{name:"setAssigned",label:"Set Assigned"},{name:"setAvailable",label:"Set Available"},{name:"clear",label:"Clear"}],B=u=>{a.form.amount=u},x=()=>{m.value.amount=0},_=u=>{switch(u){case"setAssigned":B(t.category.budgeted);break;case"setAvailable":B(t.category.available);break;default:x();break}};return(u,s)=>{const C=Q("auto-animate");return G((i(),y("section",Ae,[!a.isEditing&&!a.hasTarget?(i(),E(V,{key:0,onClick:s[0]||(s[0]=d=>a.isEditing=!0),class:"bg-body-1/5 py-2 px-2 rounded-md text-body-1 w-full flex items-center"},{default:c(()=>[o("span",Le,[r(xe)]),h(" Set target ")]),_:1})):a.isEditing?(i(),y("div",je,[r(n(F),{label:"Target Type"},{default:c(()=>[r(n(A),{filterable:"",clearable:"",size:"large",value:n(m).target_type,"onUpdate:value":s[1]||(s[1]=d=>n(m).target_type=d),"default-expand-all":!0,options:n(ke)},null,8,["value","options"]),u.errors?(i(),E(n(P),{key:0,errors:u.errors,field:"account_id"},null,8,["errors"])):k("",!0)]),_:1}),r(n(F),{label:"Amount",errors:"errors",field:"amount"},{default:c(()=>[r(n(j),{"number-format":!0,modelValue:n(m).amount,"onUpdate:modelValue":s[2]||(s[2]=d=>n(m).amount=d)},{prefix:c(()=>[Ie]),suffix:c(()=>[r(n(me),{trigger:"click",options:S,"key-field":"name","on-select":_},{default:c(()=>[r(V,null,{default:c(()=>[Ye]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(m).target_type=="spending"?(i(),y("section",Ue,[r(n(R),{modelValue:n(m).frequency,"onUpdate:modelValue":s[3]||(s[3]=d=>n(m).frequency=d),options:n(qe),class:"text-sm","selected-class":"text-white bg-primary"},null,8,["modelValue","options"]),["MONTHLY","WEEKLY"].includes(n(m).frequency)?(i(),E(n(F),{key:0,label:"Every",errors:u.errors,field:v.value.field},{default:c(()=>[r(n(A),{filterable:"",clearable:"",size:"large",value:n(m)[v.value.field],"onUpdate:value":s[4]||(s[4]=d=>n(m)[v.value.field]=d),"default-expand-all":!0,options:v.value.options},null,8,["value","options"]),o("div",ze,[(i(!0),y(I,null,Y(q.value,d=>(i(),y("div",{class:"w-full h-2 bg-primary",key:d}))),128))])]),_:1},8,["errors","field"])):k("",!0)])):k("",!0),n(we)(n(m))?(i(),E(n(F),{key:1,label:"Date",class:"w-full"},{default:c(()=>[r(n(fe),{type:"date",size:"large","onUpdate:value":s[5]||(s[5]=d=>n(m).frequency_date=d)})]),_:1})):k("",!0),o("div",He,[o("div",We,[r(n(M),{class:"block h-full text-gray-500",onClick:l},{default:c(()=>[h(" Cancel ")]),_:1})]),r(n(M),{class:"block h-full text-white rounded-md bg-primary",onClick:s[6]||(s[6]=d=>f())},{default:c(()=>[h(" Save ")]),_:1})])])):(i(),E(Ne,{key:2,item:e.item,category:e.category,class:"w-full",onEdit:s[7]||(s[7]=d=>a.isEditing=!0)},null,8,["item","category"]))])),[[C]])}}},Pe={class:"flex items-center justify-between mt-2 mb-2"},Re={class:"flex items-center justify-center px-1"},it={__name:"BudgetDetailForm",props:{parentId:{type:Number,default:null},full:{type:Boolean,default:!1},category:{type:Object,required:!0},item:{type:Object,default:()=>{}}},emits:["update:category"],setup(e,{emit:b}){const t=e,a=z({category_id:null,parent_id:null,color:t.category.color||W(),name:t.category.name,amount:0,assigned:0,target_type:"",frequency:"MONTHLY",frequency_month_date:null,frequency_week_day:null,frequency_date:null,frequency_interval:0,frequency_interval_unit:0});H(()=>t.item,f=>{f?(a.reset(),Object.keys(a.data()).forEach(l=>{a[l]=f[l]||a[l]})):a.reset()},{deep:!0,immediate:!0});const v=f=>{axios.put(`/budgets/${t.category.id}?json=true`,f).then(()=>{b("update:category",f)})};return(f,l)=>(i(),y("section",{class:U(["px-5 pt-2 pb-4 space-y-4 text-left border-b rounded-md shadow-xl bg-base-lvl-3",{flex:!e.full}])},[o("header",Pe,[r(n(j),{modelValue:e.category.name,"onUpdate:modelValue":l[2]||(l[2]=g=>e.category.name=g),class:"border-transparent cursor-pointer hover:text-primary hover:border-primary",rounded:""},{prefix:c(()=>[o("div",Re,[r(ve,{modelValue:e.category.color,"onUpdate:modelValue":[l[0]||(l[0]=g=>e.category.color=g),l[1]||(l[1]=g=>v(e.category))]},null,8,["modelValue"])])]),_:1},8,["modelValue"]),r(V,{onClick:l[3]||(l[3]=g=>f.$emit("close"))},{default:c(()=>[r(ye)]),_:1})]),r(Ke,{"parent-id":e.parentId,category:e.category,item:e.item,onDelete:l[4]||(l[4]=g=>f.$emit("delete"))},null,8,["parent-id","category","item"]),k("",!0),o("div",null,[h(" Available Balance "),r($,{title:"Left Over from last month",value:e.category.prevMonthLeftOver},null,8,["value"]),r($,{title:"Assigned this month",value:e.category.budgeted},null,8,["value"]),r($,{title:"Cash expending",value:e.category.activity},null,8,["value"]),r($,{title:"Credit expending",value:e.category.activity},null,8,["value"])]),k("",!0)],2))}};export{it as _};
