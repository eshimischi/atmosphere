import{_ as S}from"./ActionSection.37619ad2.js";import{J as F}from"./Button.bbd6a321.js";import{J as B}from"./DialogModal.dd91593d.js";import{J as M}from"./Input.5bef6e23.js";import{J as V}from"./InputError.568ba953.js";import{J as k}from"./SecondaryButton.be310ea7.js";import{l as f,o as r,c,d as s,k as q,a,b as o,i as d,t as h,af as A,n as x,s as R,a5 as D,q as T,g as v,f as C,e as p,F as E,h as I,a6 as j}from"./app.cefd7668.js";import{_ as L}from"./_plugin-vue_export-helper.cdc0426e.js";import{J as N}from"./DangerButton.c2ae1c9b.js";import"./SectionTitle.927a3230.js";import"./Modal.a2277346.js";/* empty css                                              */const K={emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:F,JetDialogModal:B,JetInput:M,JetInputError:V,JetSecondaryButton:k},data(){return{confirmingPassword:!1,form:{password:"",error:""}}},methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then(l=>{l.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>this.$refs.password.focus(),250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(()=>{this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}).catch(l=>{this.form.processing=!1,this.form.error=l.response.data.errors.password[0],this.$refs.password.focus()})},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}},Y={class:"mt-4"},H=d(" Cancel ");function Q(l,t,u,P,n,i){const g=f("jet-input"),y=f("jet-input-error"),m=f("jet-secondary-button"),b=f("jet-button"),e=f("jet-dialog-modal");return r(),c("span",null,[s("span",{onClick:t[0]||(t[0]=(..._)=>i.startConfirmingPassword&&i.startConfirmingPassword(..._))},[q(l.$slots,"default")]),a(e,{show:n.confirmingPassword,onClose:i.closeModal},{title:o(()=>[d(h(u.title),1)]),content:o(()=>[d(h(u.content)+" ",1),s("div",Y,[a(g,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:n.form.password,"onUpdate:modelValue":t[1]||(t[1]=_=>n.form.password=_),onKeyup:A(i.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),a(y,{message:n.form.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[a(m,{onClick:i.closeModal},{default:o(()=>[H]),_:1},8,["onClick"]),a(b,{class:x(["ml-2",{"opacity-25":n.form.processing}]),onClick:i.confirmPassword,disabled:n.form.processing},{default:o(()=>[d(h(u.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show","onClose"])])}const w=L(K,[["render",Q]]),z={class:"text-lg font-medium"},G=s("div",{class:"mt-3 max-w-xl text-sm text-body-1"},[s("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),U={key:0},W={key:0},O=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),X=["innerHTML"],Z={key:1},$=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),ee={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},oe={class:"mt-5"},te={key:0},se=d(" Enable "),re={key:1},ae=d(" Regenerate Recovery Codes "),ne=d(" Show Recovery Codes "),ie=d(" Disable "),be={__name:"TwoFactorAuthenticationForm",setup(l){const t=R({enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}),u=()=>{t.enabling=!0,j.Inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([P(),n()]),onFinish:()=>t.enabling=!1})},P=()=>axios.get("/user/two-factor-qr-code").then(e=>{t.qrCode=e.data.svg}),n=()=>axios.get("/user/two-factor-recovery-codes").then(e=>{t.recoveryCodes=e.data}),i=()=>{axios.post("/user/two-factor-recovery-codes").then(e=>{n()})},g=()=>{t.disabling=!0,j.Inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>t.disabling=!1})},y=D().props,m=T(()=>!t.enabling&&y.value.user.two_factor_enabled),b=T(()=>m.value?"You have enabled two factor authentication.":" You have not enabled two factor authentication.");return(e,_)=>(r(),v(S,{title:"Two Factor Authentication",description:"Add additional security to your account using two factor authentication."},{content:o(()=>[s("h3",z,h(C(b)),1),G,C(m)?(r(),c("div",U,[e.qrCode?(r(),c("div",W,[O,s("div",{class:"mt-4 dark:p-4 dark:w-56 dark:bg-base-lvl-1",innerHTML:e.qrCode},null,8,X)])):p("",!0),e.recoveryCodes.length>0?(r(),c("div",Z,[$,s("div",ee,[(r(!0),c(E,null,I(e.recoveryCodes,J=>(r(),c("div",{key:J},h(J),1))),128))])])):p("",!0)])):p("",!0),s("div",oe,[C(m)?(r(),c("div",re,[a(w,{onConfirmed:i},{default:o(()=>[e.recoveryCodes.length>0?(r(),v(k,{key:0,class:"mr-3"},{default:o(()=>[ae]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:n},{default:o(()=>[e.recoveryCodes.length===0?(r(),v(k,{key:0,class:"mr-3"},{default:o(()=>[ne]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:g},{default:o(()=>[a(N,{class:x({"opacity-25":e.disabling}),disabled:e.disabling},{default:o(()=>[ie]),_:1},8,["class","disabled"])]),_:1})])):(r(),c("div",te,[a(w,{onConfirmed:u},{default:o(()=>[a(F,{type:"button",class:x({"opacity-25":e.enabling}),disabled:e.enabling},{default:o(()=>[se]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{be as default};
