import{_ as F}from"./ActionSection-921967e8.js";import{J as T}from"./Button-ca15cec9.js";import{J as S}from"./DialogModal-acc59c95.js";import{J as B}from"./Input-d726a746.js";import{J as M}from"./InputError-bdfad68a.js";import{J as C}from"./SecondaryButton-46417246.js";import{j as f,o as r,f as c,b as s,s as V,a,w as o,i as d,t as h,Q as q,n as k,y as A,a5 as R,q as J,c as v,g as p,F as D,h as E,O as j}from"./app-114b751b.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import{J as L}from"./DangerButton-f9e7e2fb.js";import"./SectionCardTitle-d72921d4.js";import"./Modal-c2871cdd.js";/* empty css                                              */const N={emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:T,JetDialogModal:S,JetInput:B,JetInputError:M,JetSecondaryButton:C},data(){return{confirmingPassword:!1,form:{password:"",error:""}}},methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then(l=>{l.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>this.$refs.password.focus(),250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(()=>{this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}).catch(l=>{this.form.processing=!1,this.form.error=l.response.data.errors.password[0],this.$refs.password.focus()})},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}},Q={class:"mt-4"};function Y(l,t,u,x,n,i){const g=f("jet-input"),y=f("jet-input-error"),m=f("jet-secondary-button"),b=f("jet-button"),e=f("jet-dialog-modal");return r(),c("span",null,[s("span",{onClick:t[0]||(t[0]=(..._)=>i.startConfirmingPassword&&i.startConfirmingPassword(..._))},[V(l.$slots,"default")]),a(e,{show:n.confirmingPassword,onClose:i.closeModal},{title:o(()=>[d(h(u.title),1)]),content:o(()=>[d(h(u.content)+" ",1),s("div",Q,[a(g,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:n.form.password,"onUpdate:modelValue":t[1]||(t[1]=_=>n.form.password=_),onKeyup:q(i.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),a(y,{message:n.form.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[a(m,{onClick:i.closeModal},{default:o(()=>[d(" Cancel ")]),_:1},8,["onClick"]),a(b,{class:k(["ml-2",{"opacity-25":n.form.processing}]),onClick:i.confirmPassword,disabled:n.form.processing},{default:o(()=>[d(h(u.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show","onClose"])])}const w=K(N,[["render",Y]]),H={class:"text-lg font-medium"},I=s("div",{class:"mt-3 max-w-xl text-sm text-body-1"},[s("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),O={key:0},z={key:0},G=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),U=["innerHTML"],W={key:1},X=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),Z={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},$={class:"mt-5"},ee={key:0},oe={key:1},pe={__name:"TwoFactorAuthenticationForm",setup(l){const t=A({enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}),u=()=>{t.enabling=!0,j.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([x(),n()]),onFinish:()=>t.enabling=!1})},x=()=>axios.get("/user/two-factor-qr-code").then(e=>{t.qrCode=e.data.svg}),n=()=>axios.get("/user/two-factor-recovery-codes").then(e=>{t.recoveryCodes=e.data}),i=()=>{axios.post("/user/two-factor-recovery-codes").then(e=>{n()})},g=()=>{t.disabling=!0,j.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>t.disabling=!1})},y=R().props,m=J(()=>!t.enabling&&y.user.two_factor_enabled),b=J(()=>m.value?"You have enabled two factor authentication.":" You have not enabled two factor authentication.");return(e,_)=>(r(),v(F,{title:"Two Factor Authentication",description:"Add additional security to your account using two factor authentication."},{content:o(()=>[s("h3",H,h(b.value),1),I,m.value?(r(),c("div",O,[e.qrCode?(r(),c("div",z,[G,s("div",{class:"mt-4 dark:p-4 dark:w-56 dark:bg-base-lvl-1",innerHTML:e.qrCode},null,8,U)])):p("",!0),e.recoveryCodes.length>0?(r(),c("div",W,[X,s("div",Z,[(r(!0),c(D,null,E(e.recoveryCodes,P=>(r(),c("div",{key:P},h(P),1))),128))])])):p("",!0)])):p("",!0),s("div",$,[m.value?(r(),c("div",oe,[a(w,{onConfirmed:i},{default:o(()=>[e.recoveryCodes.length>0?(r(),v(C,{key:0,class:"mr-3"},{default:o(()=>[d(" Regenerate Recovery Codes ")]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:n},{default:o(()=>[e.recoveryCodes.length===0?(r(),v(C,{key:0,class:"mr-3"},{default:o(()=>[d(" Show Recovery Codes ")]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:g},{default:o(()=>[a(L,{class:k({"opacity-25":e.disabling}),disabled:e.disabling},{default:o(()=>[d(" Disable ")]),_:1},8,["class","disabled"])]),_:1})])):(r(),c("div",ee,[a(w,{onConfirmed:u},{default:o(()=>[a(T,{type:"button",class:k({"opacity-25":e.enabling}),disabled:e.enabling},{default:o(()=>[d(" Enable ")]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{pe as default};
