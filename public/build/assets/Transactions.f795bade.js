import{b as B,Z as D,E}from"./atmosphere-ui.588c294c.js";import{o as p,c as b,d as n,D as y,r as M,s as N,a as m,b as l,t as x,f as i,n as L,m as R,i as g,a6 as _,g as w,F as C,h as T,k as z,a3 as j,e as O,B as V,q as S,C as q}from"./app.cefd7668.js";import{d as F,J as H,_ as P}from"./AppLayout.cd77f56f.js";import"./exact-math.node.6f837759.js";/* empty css                                              */import{aa as W,ad as A,a6 as J,a7 as U}from"./index.de789d8e.js";import{u as Z,_ as Y,a as G}from"./useServerSearch.d123d8c9.js";import{_ as Q}from"./CustomTable.5dfe0d52.js";import{_ as X}from"./_plugin-vue_export-helper.cdc0426e.js";import{p as K}from"./index.557802c7.js";import{s as I}from"./index.fe789daa.js";import{f as ee}from"./formatMoney.a91b934f.js";import{N as te}from"./Dropdown.49d2a56b.js";import{_ as ae}from"./LogerButton.0789417e.js";import"./Modal.a2277346.js";import"./LogerInput.bec0734e.js";import"./SectionTitle.23b660a7.js";import"./ImportResourceModal.ab0a2563.js";import"./SectionNav.d2e4d6cd.js";function se(e,t){W(2,arguments);var o=A(e),a=A(t);return o.getTime()>a.getTime()}const ne={name:"IcSharpSyncAlt"},re={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"1em",height:"1em",viewBox:"0 0 24 24"},oe=n("path",{fill:"currentColor",d:"m18 12l4-4l-4-4v3H3v2h15zM6 12l-4 4l4 4v-3h15v-2H6z"},null,-1),le=[oe];function ie(e,t,o,a,s,c){return p(),b("svg",re,le)}const ce=X(ne,[["render",ie]]),de={WITHDRAW:"outflow",DEPOSIT:"inflow"},ue=[{label:"Date",name:"date",width:200,class:"text-center",headerClass:"text-center",render(e){const t=K(e.date),o=se(I(t),I(new Date));return y("div",{class:o?"text-danger":"text-info cursor-pointer"},J(t,"dd MMM, yyyy"))}},{label:"Payee",name:"payee",width:400,class:"w-full",render(e){var t;try{const o=()=>{var a;return[y("div",`Transfer: ${(a=e.category)==null?void 0:a.name}`),y(ce,{class:"fa fa-right-left"})]};return((t=e.payee)==null?void 0:t.name)||y("div",{class:"flex justify-between items-center text-body-1"},o)}catch(o){return console.log(o),""}}},{label:"Category",name:"transactionCategory",render(e){var t;return(t=e.transactionCategory)==null?void 0:t.name}},{label:"Description",name:"description",width:300},{label:"Type",name:"direction",width:300,class:"text-center",headerClass:"text-center",render(e){return de[e.direction]}},{label:"Amount",name:"total",type:"custom",class:"text-right",headerClass:"text-right"},{label:"Status",name:"status",width:200,class:"py-1 flex items-center justify-center",headerClass:"text-center",render(e){const t={draft:"secondary",planned:"warning",verified:"success"};return()=>y(B,{type:t[e.status]},()=>e.status)}},{label:"",name:"actions",width:300,type:"custom",class:"text-right"}],pe={class:"pb-20 mt-5 bg-base-lvl-3"},me={class:"capitalize text-xs"},fe=n("button",{class:"hover:bg-base-lvl-3 px-2"},[n("i",{class:"fa fa-ellipsis-v"})],-1),he={__name:"TransactionTemplate",props:{transactions:{type:Array,default:()=>[]},serverSearchOptions:{type:Object,default:()=>({})},title:{type:String,default:"s"}},emits:["removed","edit","approved"],setup(e,{emit:t}){const o=M(!1),a=N({recurrence:!1,automatic:!1,transactionData:null}),s=u=>{a.transactionData=u,o.value=!0},c=u=>[{name:"edit",label:"Edit"},{name:"removed",label:"Remove"},{name:"findLinked",label:"Find Linked",hide:u.status!="draft"}].filter(d=>!d.hide),h=(u,f)=>{t(u,f)},k=u=>{var f;return(f=u.payee)!=null&&f.name?u.direction=="WITHDRAW"?"text-red-400":"text-green-500":"text-body-1"};return(u,f)=>(p(),b("div",pe,[m(Q,{cols:i(ue),"show-prepend":!0,"table-data":e.transactions,onEdit:s},{total:l(({scope:{row:d}})=>[n("div",{class:L(["font-bold",[k(d)]])},x(i(ee)(d.total,d.currency_code)),3)]),description:l(({scope:{row:d}})=>[n("span",me,x(d.description)+" "+x(d.linked),1)]),actions:l(({scope:{row:d}})=>[n("div",null,[m(i(te),{trigger:"click","key-field":"name",options:c(d),"on-select":r=>h(r,d),onClick:f[0]||(f[0]=R(()=>{},["stop"]))},{default:l(()=>[fe]),_:2},1032,["options","on-select"])])]),_:1},8,["cols","table-data"])]))}},_e={class:"flex items-center w-full space-x-2"},be=n("i",{class:"block mr-2 fa fa-check"},null,-1),ve=g(" Approve "),xe=n("i",{class:"block mr-2 fa fa-times"},null,-1),ye=g(" Remove"),ge=n("i",{class:"block fa fa-robot"},null,-1),$e={__name:"DraftButtons",setup(e){const t=()=>{axios.post("/api/automation/run-all").then(s=>{console.log(s.data)}).catch(s=>{console.log(s)})},o=()=>{_.Inertia.post("/transactions/remove-all-drafts").then(s=>{_.Inertia.reload()})},a=s=>{_.Inertia.post("/transactions/approve-all-drafts").then(()=>{_.Inertia.reload()})};return(s,c)=>(p(),b("div",_e,[m(i(D),{class:"flex items-center h-10 space-x-2 text-primary",rounded:"",onClick:c[0]||(c[0]=h=>a())},{default:l(()=>[be,ve]),_:1}),m(i(D),{class:"flex items-center h-10 mr-2 space-x-2 text-primary",rounded:"",onClick:c[1]||(c[1]=h=>o())},{default:l(()=>[xe,ye]),_:1}),m(i(D),{class:"flex items-center h-10 space-x-2 text-white bg-primary",rounded:"",onClick:c[2]||(c[2]=h=>t())},{default:l(()=>[ge]),_:1})]))}},we={class:"inline-flex rounded-md"},ke={type:"button",class:"inline-flex items-center px-3 py-2 text-sm font-medium leading-4 transition border border-transparent rounded-md text-body hover:bg-base-lvl-2 hover:text-body/80 focus:outline-none focus:bg-base-lvl-1"},De=n("svg",{class:"ml-2 -mr-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),Ce={key:0,class:"w-60"},Te={class:"block px-4 py-2 text-xs text-body-1"},Se=n("div",{class:"border-t border-gray-100"},null,-1),Ae={__name:"LogerDropdown",props:{items:{type:Array,required:!0},label:{type:String,required:!0},disabled:{type:Boolean}},setup(e){return(t,o)=>(p(),w(H,{align:"right",width:"60"},{trigger:l(()=>[n("span",we,[n("button",ke,[g(x(e.label)+" ",1),De])])]),content:l(()=>[e.disabled?O("",!0):(p(),b("div",Ce,[(p(!0),b(C,null,T(e.items,(a,s)=>(p(),b(C,{key:s},[n("div",Te,x(a.label),1),z(t.$slots,i(j.exports.kebabCase)(s),{},()=>[n("div",null,[(p(!0),b(C,null,T(a.sections,(c,h)=>(p(),w(F,{href:c.url,key:h},{default:l(()=>[g(x(c.label),1)]),_:2},1032,["href"]))),128))])]),Se],64))),128))]))]),_:3}))}},Ie={class:"flex items-center w-full space-x-2"},Oe=g(" Import Transactions "),Qe={__name:"Transactions",props:{transactions:{type:Object,default:()=>({data:[]})},accounts:{type:Array,default:()=>[]},categories:{type:Array,default(){return[]}},serverSearchOptions:{type:Object,default:()=>({})},accountId:{type:[Number,null]}},setup(e){const t=e,{openTransferModal:o}=U(),{serverSearchOptions:a}=V(t),{state:s,executeSearch:c}=Z(a),h=S(()=>{var r;return(r=a.value.filters)==null?void 0:r.account_id});q("selectedAccountId",h.value);const k=S(()=>{var r;return((r=a.value.filters)==null?void 0:r.status)=="draft"}),u=r=>{_.Inertia.delete(`/transactions/${r.id}`,{onSuccess(){_.Inertia.reload()}})},f=r=>{_.Inertia.patch(`/transactions/${r.id}/linked`,{onSuccess(){_.Inertia.reload()}})},d=r=>{o({transactionData:r})};return(r,v)=>(p(),w(P,{onBack:v[2]||(v[2]=$=>r.$inertia.visit(r.route("finance"))),"show-back-button":!0},{header:l(()=>[m(Y,null,{actions:l(()=>[n("div",Ie,[m(Ae,{label:"Status",items:{status:{label:"Status",sections:{draft:{label:"Drafts"},verified:{label:"Verified"}}}}}),m(i(E),{class:"w-full h-12 border-none bg-base-lvl-1 text-body",startDate:i(s).dates.startDate,"onUpdate:startDate":v[0]||(v[0]=$=>i(s).dates.startDate=$),endDate:i(s).dates.endDate,"onUpdate:endDate":v[1]||(v[1]=$=>i(s).dates.endDate=$),controlsClass:"bg-transparent text-body hover:bg-base-lvl-1","next-mode":"month"},null,8,["startDate","endDate"]),m(ae,{variant:"inverse"},{default:l(()=>[Oe]),_:1}),i(k)?(p(),w($e,{key:0})):O("",!0)])]),_:1})]),default:l(()=>[m(G,{title:"Transactions",accounts:e.accounts},{default:l(()=>[m(he,{transactions:e.transactions.data,"server-search-options":i(a),onFindLinked:f,onRemoved:u,onEdit:d},null,8,["transactions","server-search-options"])]),_:1},8,["accounts"])]),_:1}))}};export{Qe as default};
