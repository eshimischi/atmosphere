import{_ as F}from"./ActionSection.99ad00ce.js";import{J as T}from"./Button.acc3bf6c.js";import{J as B}from"./DialogModal.9c343722.js";import{J as M}from"./Input.895ce399.js";import{J as V}from"./InputError.7441ca17.js";import{J as k}from"./SecondaryButton.04efa480.js";import{v as f,o as r,a as c,b as s,g as R,d as a,w as o,f as d,t as h,P as q,y as x,h as A,U as D,c as j,k as v,u as C,i as p,F as E,e as I,l as S}from"./app.e738c84d.js";import{_ as L}from"./plugin-vue_export-helper.21dcd24c.js";import{J as N}from"./DangerButton.cf241726.js";import"./SectionTitle.bd705cad.js";import"./Modal.40de7d4e.js";const K={emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:T,JetDialogModal:B,JetInput:M,JetInputError:V,JetSecondaryButton:k},data(){return{confirmingPassword:!1,form:{password:"",error:""}}},methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then(l=>{l.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>this.$refs.password.focus(),250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(()=>{this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}).catch(l=>{this.form.processing=!1,this.form.error=l.response.data.errors.password[0],this.$refs.password.focus()})},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}},Y={class:"mt-4"},H=d(" Cancel ");function Q(l,t,u,P,n,i){const g=f("jet-input"),y=f("jet-input-error"),m=f("jet-secondary-button"),b=f("jet-button"),e=f("jet-dialog-modal");return r(),c("span",null,[s("span",{onClick:t[0]||(t[0]=(..._)=>i.startConfirmingPassword&&i.startConfirmingPassword(..._))},[R(l.$slots,"default")]),a(e,{show:n.confirmingPassword,onClose:i.closeModal},{title:o(()=>[d(h(u.title),1)]),content:o(()=>[d(h(u.content)+" ",1),s("div",Y,[a(g,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:n.form.password,"onUpdate:modelValue":t[1]||(t[1]=_=>n.form.password=_),onKeyup:q(i.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),a(y,{message:n.form.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[a(m,{onClick:i.closeModal},{default:o(()=>[H]),_:1},8,["onClick"]),a(b,{class:x(["ml-2",{"opacity-25":n.form.processing}]),onClick:i.confirmPassword,disabled:n.form.processing},{default:o(()=>[d(h(u.button),1)]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show","onClose"])])}var w=L(K,[["render",Q]]);const U={class:"text-lg font-medium"},z=s("div",{class:"mt-3 max-w-xl text-sm text-slate-400"},[s("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),G={key:0},W={key:0},O=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),X=["innerHTML"],Z={key:1},$=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),ee={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},oe={class:"mt-5"},te={key:0},se=d(" Enable "),re={key:1},ae=d(" Regenerate Recovery Codes "),ne=d(" Show Recovery Codes "),ie=d(" Disable "),ye={setup(l){const t=A({enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}),u=()=>{t.enabling=!0,S.Inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([P(),n()]),onFinish:()=>t.enabling=!1})},P=()=>axios.get("/user/two-factor-qr-code").then(e=>{t.qrCode=e.data.svg}),n=()=>axios.get("/user/two-factor-recovery-codes").then(e=>{t.recoveryCodes=e.data}),i=()=>{axios.post("/user/two-factor-recovery-codes").then(e=>{n()})},g=()=>{t.disabling=!0,S.Inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>t.disabling=!1})},y=D().props,m=j(()=>!t.enabling&&y.value.user.two_factor_enabled),b=j(()=>m.value?"You have enabled two factor authentication.":" You have not enabled two factor authentication.");return(e,_)=>(r(),v(F,{title:"Two Factor Authentication",description:"Add additional security to your account using two factor authentication."},{content:o(()=>[s("h3",U,h(C(b)),1),z,C(m)?(r(),c("div",G,[e.qrCode?(r(),c("div",W,[O,s("div",{class:"mt-4 dark:p-4 dark:w-56 dark:bg-slate-600",innerHTML:e.qrCode},null,8,X)])):p("",!0),e.recoveryCodes.length>0?(r(),c("div",Z,[$,s("div",ee,[(r(!0),c(E,null,I(e.recoveryCodes,J=>(r(),c("div",{key:J},h(J),1))),128))])])):p("",!0)])):p("",!0),s("div",oe,[C(m)?(r(),c("div",re,[a(w,{onConfirmed:i},{default:o(()=>[e.recoveryCodes.length>0?(r(),v(k,{key:0,class:"mr-3"},{default:o(()=>[ae]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:n},{default:o(()=>[e.recoveryCodes.length===0?(r(),v(k,{key:0,class:"mr-3"},{default:o(()=>[ne]),_:1})):p("",!0)]),_:1}),a(w,{onConfirmed:g},{default:o(()=>[a(N,{class:x({"opacity-25":e.disabling}),disabled:e.disabling},{default:o(()=>[ie]),_:1},8,["class","disabled"])]),_:1})])):(r(),c("div",te,[a(w,{onConfirmed:u},{default:o(()=>[a(T,{type:"button",class:x({"opacity-25":e.enabling}),disabled:e.enabling},{default:o(()=>[se]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{ye as default};
