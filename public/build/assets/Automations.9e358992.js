import{s as x,o as r,g as b,b as d,a as u,d as e,f as k,c,h as m,t as a,F as p,i as I,H as C,a6 as g}from"./app.cefd7668.js";import{Z as O}from"./atmosphere-ui.588c294c.js";import{_ as M}from"./AppLayout.cd77f56f.js";import{_ as E}from"./AutomationModal.b406fc32.js";import{_ as L}from"./SettingsSectionNav.9ed9b9bc.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.de789d8e.js";import"./Modal.a2277346.js";/* empty css                                              */import"./LogerInput.bec0734e.js";import"./SectionNav.d2e4d6cd.js";const B={class:"py-12"},N={class:"h-auto mx-auto max-w-7xl sm:px-6 lg:px-8"},S={class:"flex items-center justify-between mb-5 border-4 border-white rounded-md bg-gray-50"},$=e("div",{class:"px-5 font-bold text-gray-600"},"Automations",-1),G=I(" Add Automation "),P=["onClick"],T=["src"],D={class:"ml-5"},V={class:"ml-2"},F={class:"w-full integrations-form"},K={class:"left"},R={class:"head"},X={class:"tagline"},Z={class:"text-right automations"},j=e("div",{class:"text-right options"},"options",-1),ot={__name:"Automations",props:{services:{type:Array,default(){return[]}},integrations:{type:Array,default(){return[]}},recipes:{type:Array,default(){return[]}},tasks:{type:Array,default(){return[]}}},setup(n){const i=x({showAddConnection:!1,authInstance:null,isAutomationModalOpen:!1,openedAutomation:{}}),h=(s,o)=>{i.isAutomationModalOpen=!0,i.openedAutomation={board:s,stage:o}},_=()=>{C(()=>{i.isAutomationModalOpen=!1,g.Inertia.reload("/integrations",{only:["integrations"],preserveState:!0})})},f=s=>{switch(s.name.toLowerCase()){case"google":case"gmail":y(s.name.toLowerCase(),s);break}},y=(s,o)=>{gapi.load("auth2",()=>{gapi.auth2.init({apiKey:process.env.MIX_GOOGLE_APP_KEY,clientId:process.env.MIX_GOOGLE_CLIENT_ID,accessType:"offline",scope:"profile https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/calendar.readonly",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest","https://sheets.googleapis.com/discovery/rest?version=v4"]}).then(async()=>{const t=gapi.auth2.getAuthInstance(),l=t.currentUser.get();l.getAuthResponse().session_state||await t.signIn();const v=l.getBasicProfile();await t.grantOfflineAccess({authuser:l.getAuthResponse().session_state.extraQueryParams.authuser}).then(({code:w})=>{const A={code:w,service_id:o.id,service_name:o.name,user:v.getEmail()};axios.post("/services/google",{credentials:A}).then(()=>{g.Inertia.get("/integrations",{only:["integrations"],preserveState:!0})})})})})};return(s,o)=>(r(),b(M,null,{header:d(()=>[u(L)]),default:d(()=>[e("div",B,[e("div",N,[e("div",S,[$,u(k(O),{class:"text-white bg-primary",onClick:h},{default:d(()=>[G]),_:1})]),(r(!0),c(p,null,m(n.services,t=>(r(),c("div",{key:t.id,onClick:l=>f(t),class:"flex px-5 py-3 bg-base-lvl-1 shadow-md cursor-pointer"},[e("div",null,[e("img",{src:t.logo,class:"w-9"},null,8,T)]),e("h2",D,a(t.name),1),e("p",V,a(t.description),1)],8,P))),128)),e("div",F,[(r(!0),c(p,null,m(n.integrations,t=>(r(),c("div",{class:"grid grid-cols-3 px-5 py-3 my-2 font-bold text-gray-500 bg-base-lvl-1 cursor-pointer app-service__item",key:t.id},[e("div",K,[e("div",R,a(t.name)+" "+a(t.hash),1),e("div",X,a(t.hash)+" "+a(t.created_at),1)]),e("div",Z,a(t.automations.length),1),j]))),128))]),u(E,{show:i.isAutomationModalOpen,"record-data":s.openedAutomation,closeable:!0,title:"Add a new automation",services:n.services,integrations:n.integrations,recipes:n.recipes,tasks:n.tasks,type:"event",onCancel:o[0]||(o[0]=t=>i.isAutomationModalOpen=!1),onSaved:_},null,8,["show","record-data","services","integrations","recipes","tasks"])])])]),_:1}))}};export{ot as default};
